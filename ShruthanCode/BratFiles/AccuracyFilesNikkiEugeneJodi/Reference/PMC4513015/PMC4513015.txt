Multiple imputation of covariates by fully conditional specification: Accommodating the substantive model

Abstract

Missing covariate data commonly occur in epidemiological and clinical research, and are often dealt with using multiple imputation. Imputation of partially observed covariates is complicated if the substantive model is non-linear (e.g. Cox proportional hazards model), or contains non-linear (e.g. squared) or interaction terms, and standard software implementations of multiple imputation may impute covariates from models that are incompatible with such substantive models. We show how imputation by fully conditional specification, a popular approach for performing multiple imputation, can be modified so that covariates are imputed from models which are compatible with the substantive model. We investigate through simulation the performance of this proposal, and compare it with existing approaches. Simulation results suggest our proposal gives consistent estimates for a range of common substantive models, including models which contain non-linear covariate effects or interactions, provided data are missing at random and the assumed imputation models are correctly specified and mutually compatible. Stata software implementing the approach is freely available.

1 Introduction

Missing data are a pervasive problem in both experimental and observational medical research, causing a loss of information and potentially biasing inferences. In this article, we focus on settings in which interest lies in fitting a substantive model relating an outcome to a number of covariates, one or more of which have missing values. The method of multiple imputation (MI) has become an extremely popular approach for accommodating missing data in statistical analyses, both generally1 and in the specific context of partially observed covariates.2 MI involves ‘filling in’ each missing value with draws from an appropriate distribution, leading to a number M of completed datasets. The substantive model can then be fitted to each of the M completed datasets, and the results combined across the M datasets using Rubin’s rules,3 which account for the uncertainty due to the fact data have been imputed. MI is most often applied under the missing at random (MAR) assumption, which stipulates that the probability that data are missing are independent of the missing values, conditional on the observed data, although MI can also be used when data are missing not at random.3

Parametric MI as originally proposed is based on a joint imputation model for the partially observed variables (conditional on any fully observed variables), which we refer to as ‘joint model MI’. A popular alternative to joint model MI is the fully conditional specification (FCS) approach.4,5 FCS MI involves specifying a series of univariate models for the conditional distribution of each partially observed variable given the other variables. This permits a great deal of flexibility, since an appropriate regression model can be selected for each variable (e.g. linear regression for continuous variables, logistic regression for binary variables). Consequently, FCS MI is particularly appealing in settings in which a number of variables have missing data, some of which are continuous and some of which are discrete.

One of the strengths of MI is that it divides the process of dealing with missingness (the imputation stage) from the analysis of the completed data (the analysis stage). As has been previously discussed in detail, this division presents both opportunities and threats.6–9. For example, we may be able to include so-called auxiliary variables in the imputation model which are not used in the analysis stage. This offers the potential for increased efficiency and may also improve the plausibility of the MAR assumption holding, by conditioning on auxiliary variables which are predictive of missingness. Sometimes the imputer and analyst will be different people. If the imputer has additional knowledge which enables him to impose (correct) additional assumptions in the imputation model, the analyst will gain efficiency.

The division may however sometimes lead to problems. In the context of imputing partially observed covariates, imputations might be generated from a model which is incompatible with the substantive model, which may lead to (asymptotically) biased estimates of parameters in the latter. Two conditional models are said to be incompatible if there exists no joint model for which the conditionals (for the relevant variables) equal these conditional models. This is a particular issue when the substantive model contains non-linear covariate effects or interactions, with which default imputation model choices may be incompatible. For example, suppose the substantive model is the linear regression of Y on a continuous covariate X and X2, and we wish to impute missing values in X. The default choice for the imputation model for   in software for MI is a normal linear model, with conditional mean equal to a linear function of Y, which is incompatible with the quadratic substantive model. Following imputation of X, X2 is then passively imputed by squaring the imputed X values. In this case, estimates of the parameters of the substantive model from multiply imputed datasets will be biased (unless the quadratic coefficient is in truth zero), because within the subset of data where X has been imputed the association between X and Y is linear as a consequence of assuming linearity in the imputation model.10

Incompatibility between the imputation and substantive models can be avoided by specifying a joint model for outcome and covariates for which the conditional distribution of outcome given covariates matches the substantive model and then using the imputation model implied by this joint model. However, specification of a joint model is challenging when there are a number of partially observed covariates, particularly when some are continuous and some are discrete. In this setting, the FCS method is an attractive option. However, the default univariate imputation models used in FCS may be incompatible with the substantive model. In this article, we therefore propose a modification of the popular FCS approach to MI which ensures that each of the univariate imputation models is compatible with the assumed substantive model.

We begin in Section 2 by introducing a motivating example from the Alzheimer’s Disease Neuroimaging Initiative (ADNI). In Section 3, we formally define compatibility between an imputation model for partially observed covariates and a substantive model, explain when incompatibility implies imputation model mis-specification and give examples of when this occurs. We then outline how imputation models can be specified which are compatible with a given substantive model within the joint modelling approach to MI, which motivates our modification of the FCS MI approach. In Section 4, we briefly review the standard FCS framework for MI in the setting of partially observed covariates. In Section 5, we describe our modification of the FCS MI approach which ensures that each univariate imputation model is compatible with the substantive model. In Section 6 we give details for how this can be done when the model of interest is (i) normal linear regression, (ii) a model for a discrete outcome (e.g. logistic and Poisson regression) or (iii) a proportional hazards model. We report the results of a simulation study to investigate the performance of our proposed approach in Section 7. In Section 8, we apply our proposed approach to the motivating example. In Section 9, we discuss how our proposed approach can be used when, as is often the case, interest lies in fitting a number of different substantive models to the data. We conclude in Section 10 with a discussion.

2 Motivating example

The ADNI was launched in 2003 by the National Institute on Aging (NIA), the National Institute of Biomedical Imaging and Bioengineering (NIBIB), the Food and Drug Administration (FDA), private pharmaceutical companies and nonprofit organisations, as a 5-year public–private partnership. The aims of ADNI included assessing the ability of imaging and other biomarkers to measure the progression of mild cognitive impairment and early Alzheimer’s disease (AD). The study aimed to recruit approximately 200 cognitively normal older individuals (controls), 400 with mild cognitive impairment (MCI) and 200 with early AD. Participants underwent clinical and cognitive assessment and MRI brain scans at baseline and at specified intervals (every 6 or 12 months, depending on subject group) up to 3 years. Further details regarding ADNI are given in the acknowledgements.

Recently Jack et al.11 used data from ADNI to investigate baseline predictors of time to conversion to AD in those subjects with MCI at baseline. In particular, using Cox proportional hazards models they found evidence of a non-linear association between amyloid β 1-42 peptides (A ) measured from cerebrospinal fluid (CSF) at baseline and log hazard of conversion. They found evidence that lower baseline hippocampal volume was predictive of increased hazard, after adjusting for total intracranial volume (a measure of head size). Jack et al.11 also found evidence that the presence of the APOE4 gene, previously shown to be associated with development of AD in a number of studies, was associated with increased hazard for conversion to AD.

Participants were invited to have CSF measured at baseline by lumbar puncture, but were not required to do so to participate in the study. Consequently, only around 50% of subjects had CSF A  measured. The analysis of Jack et al.11 was restricted to the subset of n = 218 MCI subjects for whom CSF A  was measured. In a logistic regression analysis we found no evidence that availability of CSF was related to first of time to conversion to AD or censoring, or to the event indicator (joint test p = 0.48). A second logistic regression model found evidence (p = 0.02) that having a family history of AD was associated with an increased probability of having the CSF variables recorded, which seems quite plausible since those with a family history of AD may be especially concerned about their risk of developing the disease. These results suggest a complete case analysis might reasonably be assumed to be unbiased. However, it is inefficient, since it only uses data on 50% of MCI subjects.

Table 1. Baseline characteristics of n = 382 ADNI subjects with MCI at baseline.. MCI is a heterogeneous classification, with only a certain proportion of subjects eventually going on to develop AD. For each subject their family history was collected at baseline, in particular in relation to whether their mother or father suffered from dementia or AD. Given that there is a genetic component to the disease, we were interested to investigate whether the presence of family history of AD was associated with increased hazard of conversion to AD, by including covariates indicating whether the subject’s mother and father had had AD (Table 1). Unfortunately, although family history of dementia was well recorded, family history of AD specifically suffered from missingness (see Table 1). 

We aimed to estimate the parameters of a Cox proportional hazards model for hazard of conversion to AD using the available data from the n = 382 ADNI subjects who had MCI at baseline and who had at least one follow-up visit. Of these subjects, 167 were observed to convert to AD during follow-up. Our substantive model contained as covariates the variables listed in Table 1, plus the square of A  to allow for the non-linear association previously identified by Jack et al.11. In addition to CSF A , we included CSF tau and p-tau as covariates, which are also thought to reflect pathology, and thus might be associated with hazard of conversion to AD. Tau and p-tau were log transformed to reduce skewness in their distribution. The FCS approach to MI is attractive here, since seven covariates are partially observed, with some continuous and some binary. However, we should be careful to ensure that the imputation models we use are compatible with the substantive model, which includes a quadratic effect of one of the partially observed covariates. If we impute from a model which does not allow for a potential non-linear association between (log) hazard and CSF A , we would expect to obtain inconsistent parameter estimates, particularly of the coefficients relating to CSF A .

3 MI of partially observed covariates

3.1 Setup

We consider the setting in which interest lies in fitting a model to a fully observed outcome Y (although see Section 10) with p partially observed covariates   and q fully observed covariates  . Let Xobs and Xmis denote the observed and missing components of X for a given subject, and let R be the vector of observation indicators whose elements are zero or one depending on whether the corresponding element of X is missing or observed. We assume throughout that the data are MAR.12 Here, MAR means that  . We assume that   are independent and identically distributed. Lastly, we let   denote the ‘substantive model’, which is indexed by parameter ψ ( ). We assume throughout that this substantive model is correctly specified. That is, there exists   such that  , where   denotes the true conditional distribution of Y given X and Z.

3.2 MI of partially observed covariates

In Bayesian parametric MI, to multiply impute missing values in X we specify a parametric model   for the conditional distribution  . To create the mth imputed dataset we first draw   from its posterior distribution given the observed data   and a (usually noninformative) prior f(ω). For each subject the missing values (if any) Xmis are imputed by taking a draw from the density   implied by  .

Having created M imputed datasets, the substantive model parameter ψ is then estimated separately using each imputed dataset, resulting in estimates   and corresponding variances  . In this article, we assume that the substantive model is fitted using maximum likelihood. Rubin’s rules are then invoked to provide a final inference for ψ, with the estimator of ψ given by   and an estimate of the variance of   given by   Suppose that the posited imputation model is correctly specified, so that there exists a value of   such that  . Then   is a consistent estimator of ψ, and as the number of imputations  , confidence intervals (CIs) based on   achieve coverage at or above their nominal level.6

3.3 Compatibility and imputation model mis-specification

When an imputation model   is directly specified, it may be mis-specified if it is not compatible with the substantive model (assuming this is correctly specified). For example, if the correctly specified substantive model includes an interaction between a partially observed covariate and a fully observed covariate in their effect on the outcome Y, imputation models which do not allow for this interaction will generally (unless the interaction term is in truth zero) be mis-specified. Such considerations led to recommendations that imputation models be used which do not impose restrictions which will conflict with subsequent analyses of the imputed datasets.6,7

Extending a definition given by Liu et al.,13 we now define the notion of compatibility between a set of conditional models. Let   be a vector of random variables, and let  . Let B denote a further, possibly empty, vector of random variables. Then a set of conditional models   is said to be compatible if there exists a joint model   and a collection of surjective maps   such that for each j,   and     Otherwise the set of models   is said to be incompatible.

A weaker property which we shall also use is that of semi-compatibility for a set of models. A set of models is semi-compatible if they can be made compatible by setting one or more parameters to zero. More formally (again following Liu et al.13), a set of conditional models   is said to be semi-compatible if there exists a set of compatible conditional models   such that   for j = 1, … , p. A set of compatible conditional models is always semi-compatible. If the joint model   corresponding to the set of conditionals   is correctly specified (i.e. contains the true probability distribution), we say (again following Liu et al.13) that the set of models   is valid semi-compatible.

The imputation model   is correctly specified if and only if it is valid semi-compatible with the substantive model  . As an example, suppose the substantive model is   and the imputation model is  . These two models are incompatible (this can be established by the theorem for compatibility of two conditional densities of Arnold and Press14). They are semi-compatible, with the joint model for (X, Y) being the bivariate normal, by setting  . However, they are not valid semi-compatible, unless in truth  . The imputation model is therefore mis-specified in general, and the MI estimator   will be inconsistent, as demonstrated through simulation by von Hippel15 and Seaman et al.10

It is important to note that incompatibility between the imputation and substantive models does not necessarily imply mis-specification of the former. For example, suppose the substantive model is   and the imputation model is  , with each of the regression coefficients lying in  . Then again the two models are incompatible, but are semi-compatible, with joint model the bivariate normal, by setting ω  = 0. If the data in truth are bivariate normal, the two models are valid semi-compatible, and the imputation model is correctly specified. Here, incompatibility between imputation and substantive models does not imply mis-specification of the former because a more restrictive version of the imputation model (with ω  = 0) is compatible with the substantive model.

Incompatibility may also arise when default imputation models are used for covariates in non-linear substantive models. For example, suppose T (rather than Y) is a time to event outcome which is not subject to censoring, and that the substantive model is the parametric exponential model, with hazard function  , with X a continuous partially observed covariate and h  a time constant baseline hazard. In this case  . Then suppose, following the recent recommendations of White and Royston,16 we adopt a normal linear imputation model for   with   as covariate. The two models are incompatible, and are only semi-compatible by setting ω  = 0 and  , such that T and X are independent. The imputation model can thus only be valid semi-compatible (and thus correctly specified) with the substantive model if T and X are independent. The MI estimator   will thus generally be inconsistent (although simulations by White and Royston16 show the bias is often small).

In conclusion, except in cases where the imputation and substantive models can be made compatible by restricting the parameter space Ω of the imputation model, incompatibility between the two implies the imputation model is mis-specified (assuming correct specification of the substantive model). Consequently, when choosing the covariate imputation model   we should (at least) ensure that it is either compatible with the substantive model, or a restriction of it is compatible with the substantive model.

3.4 Joint model imputation

The natural route to ensuring compatibility between the imputation and substantive models is to explicitly specify a joint model   which has the substantive model   as its corresponding conditional, and to derive the implied imputation model. Given the (correctly) specified substantive model  , such joint models are specified by defining a model  . The imputation model is then given by   We emphasise that using a compatible imputation model does not guarantee it is correctly specified – this is only true if, in addition to the substantive model being correctly specified,   is correctly specified.

In cases where p = 1 and X is univariate, specification of a model   is relatively straightforward. When X is multivariate, and particularly when it contains a mixture of continuous and discrete variables, specification of a joint model   becomes more challenging. In this setting, Ibrahim et al.17 proposed specification by factorising the joint distribution of   as a product of univariate densities of the form   This breaks the problem of joint specification into the easier task of specification of a series of univariate models. This means that appropriate univariate regression models can be specified depending on the type (i.e. continuous, discrete and ordered discrete) of each variable. However, as the dimension of X increases the number of possible orderings of its components increases rapidly, and it is not obvious which ordering should be chosen. As far as we are aware, this approach to MI has not been adopted by applied researchers. A new joint modelling approach for handling interactions and non-linearities has recently been proposed by Goldstein et al.18

4 FCS MI

In the more general setting of MI in multivariate data, the FCS approach to MI similarly splits the task of specification of a joint model into a series of univariate model specifications. In FCS MI, as we describe in further detail in Section 4.1, models are specified for each partially observed variable conditional on all other variables. In contrast to the approach proposed by Ibrahim et al.,17 there is no requirement to choose an ordering of the partially observed variables. FCS MI has now become an extremely popular approach to MI generally.5

Application of FCS for imputation of partially observed covariates involves specification of models of the form  , where   denotes the components of X with Xj removed. As we have described, for certain substantive models, such as those involving non-linear covariate effects or interactions, default choices of these imputation models within FCS will be incompatible. Further, they will not generally be valid semi-compatible with the substantive model, and will therefore be mis-specified (assuming correct specification of the substantive model). In the next sub-section, we review the standard FCS algorithm in detail, and then in Section 5 propose a modification of FCS MI which ensures that each of the covariate models   is compatible with the substantive model.

4.1 The FCS algorithm

For each partially observed covariate Xj, we posit an imputation model  , with parameter θj, where  . This is typically a generalised linear model chosen according to the type of Xj (e.g. continuous, binary and count). Furthermore, a noninformative prior distribution f(θj) for θj is specified. Let   and   denote the vectors of observed and missing values in Xj for the n subjects. Let y and z denote the vector and matrix of (fully observed) values of Y and Z across the n subjects.

The FCS algorithm begins by replacing the missing values in each Xj by randomly selected observed values from the same variable. The algorithm then proceeds by repeatedly imputing the missing values in each variable, at each stage conditioning on the most recent imputations of the other variables. Let   denote the imputations of the missing values   at iteration t and let   denote the vector of observed and imputed values at iteration t. Let  . The tth iteration of the algorithm consists of drawing from the following distributions (up to constants of proportionality)   Thus, for the partially observed covariate Xj the algorithm first draws θj from its posterior distribution given  . This is equal (up to a constant of proportionality) to the product of the prior f(θj) and the likelihood corresponding to fitting the imputation model for Xj to subjects for whom Xj is observed, using the observed and most recently imputed values of  . Missing values in Xj are then imputed from the imputation model using the parameter value drawn in the preceding step. After a sufficient number of iterations it is assumed that the algorithm has converged to a stationary distribution, and the final draws of the missing data form a single imputed dataset. The process is then repeated to create as many imputed datasets as desired. In software implementations of FCS MI, the variables are typically updated in the ordering for which the missingness pattern is closest to monotone. Finally, the substantive model is fitted to each imputed dataset, and the results combined using Rubin’s rules as described previously.

Note that when drawing θj, the FCS algorithm differs from a standard Gibbs sampler, which would draw θj from its posterior distribution proportional to  , that is, the posterior corresponding to fitting the imputation model to all subjects, using the last iteration’s imputation of  .

4.2 Statistical properties

Despite the fact that FCS MI has been applied widely in a number of fields,5 until recently few results were available regarding its validity. This is due to the fact that one can specify imputation models (which in our setting are  ) that are not mutually compatible.19 In this case, it is not clear to what distribution, if any, the algorithm will converge.

Hughes et al.20 have recently given conditions under which, at convergence, FCS draws imputations from a well-defined Bayesian joint model, which are as follows: The conditional models f(Xj|X-j,Z,Y,θj),j=1,…,p, are compatible, with corresponding joint model f(X|Z,Y,θ).. For each j = 1, … , p, this joint model can be factorised as f(X|Z,Y,θ)=f(Xj|X-j,Z,Y,θj)f(X-j|Z,θ-j), where (θj,θ-j) is a reparameterisation of θ, and θj and θ-j are variationally independent.. There exists a prior f(θ) such that for each j = 1, … ,p, f(θ)=f(θj)f(θ-j), where f(θj) is the prior used by FCS. Hughes et al.20 show that these conditions are satisfied when the conditional models are normal linear regression models, with the corresponding joint model being the multivariate normal, and the standard noninformative priors are used. Separately, Liu et al.13 have given sufficient conditions under which the stationary distribution (assuming it exists) which FCS MI draws from converges (as  ) to the posterior distribution of the missing data in a well-defined Bayesian model.

Both Hughes et al.20 and Liu et al.13 give examples where compatible conditional models are used but FCS is not equivalent to imputation from a Bayesian joint model. A common, and therefore important, example is that in which a binary variable is imputed using logistic regression conditional on a continuous variable, with the latter imputed using a normal linear regression model. Although these models are compatible with each other, FCS imputation fails to utilise the information contained in the marginal distribution of the continuous variable about the logistic regression parameters, and consequently FCS MI does not draw from a Bayesian joint model.

Even when the conditional models are not compatible, Liu et al.13 show that provided the conditional models are valid semi-compatible, the estimator   is consistent. This result can be used to conclude that in the linear-logistic example described in the previous paragraph, in which the models are compatible (and therefore also semi-compatible)   is consistent provided both models are correctly specified. Note however that since valid semi-compatibility does not guarantee FCS is equivalent to imputation from a Bayesian joint model, there is no guarantee that Rubin’s rule for the variance will provide valid inferences in this case. If the conditional models used are not even semi-compatible, in general we expect inconsistent estimates.

5 FCS imputation accommodating the substantive model

In this section, we describe how the standard FCS algorithm, described in Section 4, can be modified to ensure that each of the univariate imputation models used is compatible with the substantive model. We term the algorithm substantive model compatible FCS (SMC-FCS). To specify an imputation model for Xj, j = 1, … , p which is compatible with the substantive model, we note that   In SMC-FCS, for j = 1, … , p, we specify models  , together with noninformative priors  . Then, given values of ψ and  , we impute missing values in Xj from the density proportional to   In general this density will not belong to a standard parametric family, complicating direct simulation of values. In Section 6, we show how rejection sampling can be used to draw values from it for the most common types of substantive model.

The imputation model for Xj defined by equation (4) depends both on   and the substantive model parameter ψ. Recall that at the tth iteration of the standard FCS algorithm the parameter of the imputation model for Xj is drawn from its posterior conditional on  . Under the imputation model defined by equation (4), the posterior for   conditional on   is difficult to draw from because subjects with Xj missing contribute   to this posterior, whose calculation requires Xj to be integrated out from  .

The posterior is however easy to draw from if we condition on (as in a standard Gibbs sampler)   in addition to  . The posterior is then   Assuming we specify independent priors   and  , and the posterior is proportional to   In SMC-FCS the tth iteration consists of drawing (up to constants of proportionality)     and then drawing the missing values of Xj from the density proportional to (4).

In software implementations of the standard FCS algorithm, 10 iterations are typically used to ‘burn-in’, based on empirical experience suggesting this is often sufficient for convergence of the sampler. Since when imputing missing values in Xj SMC-FCS conditions on   (unlike standard FCS), SMC-FCS might be expected to require a larger number of iterations in order to converge to the required stationary distribution, assuming it exists. As with standard FCS, convergence can be assessed by examining plots of means of partially observed variables by iteration number, and also by examining the relative magnitude of between-chain variation and within-chain variation.

5.1 Statistical properties

In the appendix, we show that under certain conditions (essentially identical to those given by Hughes et al.20 for standard FCS), the SMC-FCS algorithm, at convergence, generates imputations from a Bayesian joint model in which the model for   is the same as the substantive model  . These conditions are as follows: The covariate models f(Xj|X-j,Z,φj),j=1,…,p, are mutually compatible, with corresponding joint model f(X|Z,φ).. For each j=1,…,p, this joint model can be factorised as f(X|Z,φ)=f(Xj|X-j,Z,φj)f(X-j|Z,φ-j), where (φj,φ-j) is a reparameterisation of φ, and φj and φ-j are variationally independent.. There exists a prior f(φ) such that for each j=1,…,p,f(φ)=f(φj)f(φ-j), where f(φj) is the prior used by SMC-FCS. As stated in Section 4.2, Hughes et al.20 have shown that these conditions are satisfied when (in our setting) the covariate models are normal linear regressions and the usual noninformative priors are used. When SMC-FCS is equivalent to imputation from a Bayesian joint model, and this model is correctly specified, we expect Rubin’s rules estimator   to be consistent and for the CIs to have nominal coverage.

Following the results of Liu et al.13 for standard FCS, if the covariate models   are valid semi-compatible, we conjecture that the MI estimator of the substantive model parameters   will still be consistent. Just as with FCS, however, there is no guarantee however that CIs based on Rubin’s variance estimator will give at least nominal coverage. Lastly, if the covariate models are not valid semi-compatible, in general, we would not expect the estimator   to be consistent.

6 Sampling from the imputation model

In this section, we give details of how the method of rejection sampling can be used to sample from the density given in equation (4) for some of the most common types of substantive model. Rejection sampling involves creating draws from a proposal density (from which it is easy to draw), until a draw is made satisfying a particular condition. We choose   as our proposal density, on the assumption that it is easy to sample from this density. To use rejection sampling, the ratio of the target density to the proposal density (up to a constant of proportionality) must be bounded above by a quantity not involving Xj.21 Here this ratio is proportional to   Let   denote an upper bound (in Xj) for  . To generate a draw from the density proportional to equation (4), we sample pairs of values   from the density given by   and U from the uniform distribution on (0,1) until   When this inequality is satisfied, the value   is a draw from the density proportional to equation (4).

We must therefore bound   by a quantity not involving Xj. The bound will depend on the specification of the substantive model. In the following sections, we derive bounds for the cases of (i) a normal regression model, (ii) a model for a discrete outcome Y and (iii) a proportional hazards survival model.

6.1 Normal regression

Suppose that the substantive model specifies that Y is normal, with conditional mean   for some function g(), and residual variance  , so that  . Then   To generate a draw for the missing value Xj, we draw a value   from  , and U from the uniform distribution on (0, 1). The draw   is accepted if   If the draw is not accepted, new draws of   and U are made until they satisfy the condition in equation (9).

6.2 Discrete outcomes

Now consider a discrete outcome Y. This includes the case of a binary outcome Y, which is commonly modelled using logistic regression. When Y is discrete,   is a probability, and hence is less than or equal to one. The rejection sampling algorithm then consists of drawing   from   and  , and accepting   when   

6.3 Proportional hazards models

Lastly, suppose that interest lies in the time T to an event of interest, but this time may be censored. Let C denote the censoring time. We observe W = min(T, C), and  , which denotes whether the subject’s event time has been observed or was censored. We assume that censoring is noninformative, in the sense that  . Furthermore, we assume  . Together these assumptions allow us to avoid modelling the censoring process.22

We assume that the substantive model is the proportional hazards model:   where   denotes the hazard at time t, h (t) denotes the baseline hazard at time t and   denotes a function of X and Z indexed by parameter β. In parametric proportional hazards models the baseline hazard function is parametrised by a finite set of parameters λ, so that  . In Cox’s proportional hazards model the baseline hazard is allowed to be arbitrary, so that   with   an infinite-dimensional parameter. Equivalently, we can parametrise the model using the baseline cumulative hazard  , so that  .

We first consider how to sample Xj for a subject for whom D = 0, that is, their time to event is censored. Then since by assumption   and     We draw   from   and  , and accept   when   

For a subject who is not censored (D = 1), we have   Since   is monotonically increasing, this expression takes its maximum when   takes its maximum. Differentiating this with respect to g() and setting the resulting expression to zero shows that this occurs when  . Therefore   We can thus draw   from   and  , and accept   when   

7 Simulation study

In this section, we describe the results of simulation studies to investigate the performance SMC-FCS in situations in which the substantive model is incompatible with standard choices for covariate imputation models.

7.1 Linear regression with quadratic covariate effects

We first simulated from a linear regression substantive model with a single covariate X with linear and quadratic effects, for which standard imputation model choices for the covariate X are incompatible.

7.1.1 Simulation setup

The outcome Y was simulated according to   with β  = 4,  , β  = 1 and  . These coefficients were chosen to give a moderately strong U-shaped association between Y and X. The variance   was chosen such that the coefficient of determination R2 was equal to 0.5.

The covariate X was simulated from a normal, a log-normal or a normal mixture distribution. For all three distributions X had mean 2 and variance 1. For the log-normal distribution, X was generated by exponentiating a draw from  . For the normal mixture distribution, X was drawn from N(1.125,0.234) with probability 0.5 and from N(2.875,0.234) with probability 0.5.

For each distribution of X, values were made missing either according to the missing completely at random (MCAR) mechanism   or the MAR mechanism  , where  ,   and α  was chosen to make the marginal probability of observing X equal to 0.7. In all simulations datasets for n = 1000 subjects were generated and 1000 simulations were performed for each scenario.

7.1.2 Estimation methods

For each simulated dataset we first imputed the missing values of X using a linear regression model with the   command in Stata. We used the default imputation model, with the expectation of X modelled as a linear function of Y. Note that since here there is only one partially observed variable, no iteration is required within FCS. Missing values of X2 were then passively imputed as the square of these imputed values of X (‘linear passive’). Second, we imputed the missing X values using the ‘transform then impute’ or ‘just another variable’ (JAV) approach proposed by von Hippel,15 that is, by treating X2 as another variable to be imputed in the   command in Stata. Third, we imputed X using the   function in the R MICE package (‘polynomial combination’). This implements a method recently proposed by van Buuren23 (p. 140), which imputes the linear combination of X and X2 which enters in the linear predictor of the substantive model, followed by solving a quadratic equation for X. Lastly, we used SMC-FCS, assuming X is marginally normally distributed for all scenarios. We chose to implement SMC-FCS using the same marginal model for X to explore the performance of (substantive model) compatible but mis-specified imputation models. For all imputation approaches, 10 imputed datasets were generated, and estimates and CIs found using Rubin’s rules. We used 10 iterations per imputation in SMC-FCS and the default 10 iterations in the   command. With X univariate, SMC-FCS is equivalent to imputation from the corresponding Bayesian model. We used standard noninformative priors for normal linear regression parameters in SMC-FCS, that is,  , where β and σ2 denote the vector of regression coefficients and residual variance, respectively.

7.1.3 Results

Table 2. Simulation results – linear regression with quadratic covariate effects. Empirical mean (SD) of estimates of quadratic coefficient β2 = 1 from 1000 simulations, using linear passive imputation, JAV imputation, the polynomial combination method and SMC-FCS. Empirical coverage of nominal 95% confidence intervals is also shown (Cov). Monte-Carlo errors for means and SDs are less than 0.003, except for log-normal X MAR, where Monte-Carlo errors for means and SDs are less than 0.02. Monte-Carlo errors for confidence interval coverage are less than 1.6%.. Table 2 shows the results of the simulations, showing the empirical mean and standard deviation of estimates of β  and the coverage of nominal 95% CIs. With normally distributed X and MCAR, linear passive imputation resulted in biased estimates, with considerable attenuation in   towards zero as expected. Here the imputation model being used is incompatible (with the substantive model) and mis-specified. CI coverage for linear passive imputation was also extremely poor, with zero coverage for β . JAV, polynomial combination and SMC-FCS gave unbiased results, with similar efficiency to each other. SMC-FCS had CI coverage close to 95%, but JAV and polynomial combination had slightly low coverage. With X log-normally distributed and MCAR linear passive imputation was again biased with poor CI coverage. JAV was unbiased, although estimates were considerably more variable SMC-FCS. Furthermore, the coverage of the CI for β  from JAV was only 83%. The polynomial combination method performed similar to JAV here. Despite the assumed model for X being mis-specified, SMC-FCS was unbiased and the 95% CI for β  had the correct coverage. With X distributed according to a normal mixture model and MCAR, JAV and polynomial combination were again unbiased. The CI coverage of JAV and polynomial combination for β  was close to 95%. Linear passive imputation continued to be severely biased. SMC-FCS was somewhat biased towards the null for β , and consequently CI coverage for β  was only 66%. 

With normal X and MAR, linear passive imputation gave biased estimates and the CI for β  had zero coverage. With data MAR, JAV no longer gave unbiased estimates, in agreement with the findings of Seaman et al.,10 and the CI for β  had only 12% coverage. Polynomial combination had only slight bias, but CI coverage for β  was only 75.9%. In contrast, SMC-FCS was unbiased and the CI for β  had approximately 95% coverage. All estimators were considerably more variable with X log-normal MAR. JAV and polynomial combination had considerable bias and poor CI coverage for β , as did linear passive imputation. Despite using a mis-specified model for the distribution of X, SMC-FCS was again unbiased, although the CI for β  had slightly lower than nominal coverage. Lastly with X distributed as a mixture of two normals and MAR, linear passive imputation continued to be substantially biased. JAV was biased to a lesser extent, although its CI for β  had poor coverage. SMC-FCS was biased (since the assumed distribution for X was incorrect) towards zero, and its CI for β  had extremely poor coverage, due to the estimator’s large bias relative to its variability. The polynomial combination method performed best here, with unbiased estimates of β  and only somewhat reduced CI coverage.

7.2 Linear regression with interaction

Next, we considered a linear regression substantive model in which two covariates interact with each other in their effect on outcome.

7.2.1 Simulation setup

The outcome Y was generated according to   with β  = 0, β  = 1, β  = 1, β  = 1, and with  , where as before,   was chosen to give R2 = 0.5.

In the first scenario, X  and X  were generated from a bivariate normal distribution, with each covariate having mean 2 and variance 1, and the correlation between the two equal to 0.5. To explore robustness of the imputation methods to violations of normality assumptions, in a second scenario   and   were generated from a bivariate normal distribution so that they both had marginal distribution   and the correlation between the two was equal to 0.5. To investigate robustness to linearity assumptions between covariates, in a third scenario we generated   and  . Fourth, we generated X  from a Bernoulli distribution with probability 0.5, and  . To explore robustness to violations of normality assumptions, in the final scenario we generated X  from a Bernoulli distribution with probability 0.5 and   where  .

Values in both X  and X  were first made (independently) MCAR, each with probability 0.7 of being observed. We then repeated the simulations with X  observed with probability   where   and α  was chosen to make the marginal probability of observing X  equal to 0.7, and with X  also observed with probability  .

7.2.2 Estimation methods

For each simulated dataset we first imputed using the   command in Stata, followed by passive imputation of the interaction term (‘passive FCS’). A linear regression imputation model was used when the covariate was continuous and a logistic regression imputation model when the covariate was binary. In the imputation model for X  (X ) the outcome Y, X  (X ) and their interaction YX  (YX ) were included as explanatory variables.

We obtained estimates using JAV by including the interaction variable X X  as an additional variable in the   command. Covariate X  (X ) was imputed using a linear regression model (even when X  was binary) with Y, X  (X ) and X X  as explanatory variables. The interaction term X X  was imputed using a linear regression model with Y, X  and X  as explanatory variables. Since all conditional imputation models are linear regressions with other variables included linearly, JAV is equivalent here to imputation from a trivariate normal imputation model for (X ,X ,X X ) conditional on Y.

Lastly, we obtained estimates using SMC-FCS, assuming a normal regression model for   or a logistic regression model when X  was binary. A linear regression model was assumed for  . When assuming   and   are linear regressions, SMC-FCS is equivalent to imputation from the Bayesian model defined by the substantive model and a bivariate normal model for (X ,X ). In contrast, when assuming a logistic regression model for   and a linear regression for  , although these models are compatible, SMC-FCS is not equivalent to imputation from a Bayesian model. When drawing from the posterior of the logistic regression parameters (equation (5)) we used a multivariate normal, with mean equal to the MLE and variance covariance corresponding to the inverse of the ‘observed’ data information matrix.

7.2.3 Results

Table 3. Simulation results – linear regression with interaction. Empirical mean (SD) of estimates of β1 = 1 and β3 = 1 from 1000 simulations, standard FCS with passive imputation (Passive FCS), JAV imputation and SMC-FCS. Empirical coverage of nominal 95% confidence intervals is also shown (Cov). Monte-Carlo errors for means and SDs are all less than 0.04 for β1 and less than 0.02 for β3. Monte-Carlo errors for confidence interval coverage are less than 1.6%.. Table 3 shows the mean (SD) estimates of β  and β  and empirical coverage of the corresponding 95% CIs. With data MCAR and X  and X  bivariate normal, passive FCS was substantially biased and had poor CI coverage for β  and β . In contrast, both JAV and SMC-FCS were unbiased. However, SMC-FCS was somewhat more efficient than JAV. CI coverage for β  was at the nominal level for both JAV and SMC-FCS. With X  and X  distributed log-normal, passive FCS had slightly larger bias for β  and β  and again poor CI coverage. JAV continued to be unbiased with correct CI coverage. SMC-FCS was somewhat biased, due to mis-specification of the models for   and  , although CI coverage was only slightly below the nominal level for β  and β . When X  was normally distributed with mean a quadratic in X , passive FCS was again biased. JAV continued to be approximately unbiased. SMC-FCS was again somewhat biased, with CI coverage for β  approximately 88%. With X  Bernoulli and   normal, both JAV and SMC-FCS were unbiased, although SMC-FCS was slightly more efficient. Both had empirical CI coverage of approximately 95% for both β  and β . It is important to note that here SMC-FCS is not equivalent to imputation a Bayesian model, and thus there is no guarantee that Rubin’s rules will give asymptotically unbiased variance estimates. That the CIs from SMC-FCS had the correct coverage in this setting is thus encouraging. Passive FCS was again biased. As expected, with X  log-normal given X  JAV continued to remain approximately unbiased while SMC-FCS had moderately large biases for β  and β , although CI coverage was only slightly below 95%. 

When X  and X  were MAR passive FCS continued to be biased for all X ,X  distributions considered. With X ,X  bivariate normal, estimates from JAV had a small bias towards zero for β , but a larger bias for β . In contrast, SMC-FCS was unbiased and more efficient. In a number of simulated datasets with covariates log-normally distributed or with X  quadratic given X  the FCS algorithm created imputed datasets with extremely large imputed values of X  and X , resulting in a co-linearity error when attempting to fit the substantive model to the imputations. Consequently, for these scenarios results are shown for the subset of the simulated datasets for which estimates from all methods were obtained. JAV was approximately unbiased for β  when the covariates were log-normally distributed, but was substantially biased for β . SMC-FCS was approximately unbiased here. With X  given X  normal with mean quadratic in X , both JAV and SMC-FCS were biased, but again biases for β  and β  were smaller for SMC-FCS. Lastly, with X  binary and X  either conditionally normal or log-normal, JAV had little bias for β , but had some bias for β . SMC-FCS was unbiased for both β  and β  when X  was conditionally normal given X . With X  log-normally distributed, both JAV and SMC-FCS were somewhat biased for β  and β , although the biases of JAV were smaller.

7.3 Cox proportional hazards models

Lastly, we performed simulations for imputing missing covariates with a Cox proportional hazards model. Recently, White and Royston16 derived approximate results to inform the choice of imputation model in this context. They recommended including the event indicator and the Nelson–Aalen estimate of the marginal cumulative hazard function as covariates in imputation models. Their simulation results showed that this approach generally worked well for imputing normally distributed covariates, except when the covariate effects were large, when some attenuation towards the null occurred.

7.3.1 Simulation setup

Survival times were simulated with hazard function   with  . Censoring times were generated from an exponential distribution with hazard 0.002. We simulated X  from a Bernoulli distribution with probability 0.5, and  . Values in X  and X  were made (independently) MCAR, with probability of observation 0.7. We performed simulations with n = 1000 subjects and also with n = 100 subjects.

7.3.2 Estimation methods

For each simulated dataset we first estimated β by fitting the Cox proportional hazards model to the complete cases (CC). Next, we multiply imputed the missing values in X  and X  using FCS (10 imputations). A linear regression imputation model was used for X  and a logistic regression model for X . Following the recommendations of White and Royston,16 we included the event indicator D and the Nelson–Aalen estimate of the marginal cumulative hazard as covariates in both imputation models (FCS). Lastly, we estimated β using SMC-FCS as described in Section 6.3, assuming a logistic regression model for   and a linear regression model for  . As described previously, the SMC-FCS algorithm involves taking draws from the posterior distribution of the parameter ψ in the substantive model. For Cox’s proportional hazards model  , where H (·) is an infinite-dimensional parameter representing the arbitrary baseline hazard function. It is unclear how a draw can be made from the posterior distribution of H (·), and indeed whether Rubin’s rules can be expected to give asymptotically unbiased variance estimates in a semi-parametric model. In our simulation study we allowed for uncertainty in β by drawing a new value from a (bivariate) normal distribution with mean equal to the current estimate of β and with covariance matrix based on the usual ‘observed’ data information matrix. We then updated H (·) using the usual Breslow estimator, conditioning on the newly drawn value of β.

7.3.3 Results

Table 4. Cox proportional hazards outcome model simulation results. Empirical mean (SD) of estimates of β1 = 1 and β2 = 1 from 1000 simulations, using complete case analysis, MI of X1 and X2 using FCS with the event indicator and Nelson–Aalen marginal baseline cumulative hazard function as covariates (FCS), and SMC-FCS. Empirical coverage of nominal 95% confidence intervals is also shown (Cov). Monte-Carlo errors in means and SDs are no more than 0.02 for n = 100 and 0.005 for n = 1000.. Table 4 shows the results from the 1000 simulations. CC is consistent here, since missingness is completely at random. However, with n = 100 CC showed some upward finite sample bias for both β  and β . In accordance with the results of White and Royston,16 FCS resulted in somewhat biased estimates, with the bias larger for the coefficient corresponding to the continuous covariate, although CI coverage for both β  and β  was approximately 95%. SMC-FCS, like CC, showed some slight upward bias, but was somewhat more efficient. Of interest was that the CIs had correct coverage, despite the fact that our implementation ignores uncertainty in the baseline hazard function. 

For n = 1000, CC was essentially unbiased. The biases of FCS were larger than for n = 100, which is due to the fact that the finite sample bias, which acted in the opposite direction to the bias caused by the approximation used in the FCS approach, had largely disappeared. Consequently, CI coverage was below the nominal 95% level, with coverage for β  particularly poor at 47%. In contrast, SMC-FCS was unbiased and had correct CI coverage.

8 Analysis of data from ADNI

Table 5. Estimates of log hazard ratios (standard errors) for Cox proportional hazards model relating hazard of conversion to AD to baseline risk factors. Estimates based on complete case, FCS imputation and SMC-FCS.. Table 5 shows the estimated log hazard ratios from the substantive model fitted to the n = 127 complete cases (of whom 61 converted to AD). This showed borderline evidence of an association between CSF A  and hazard of conversion, and borderline significant evidence of curvature in the association, in agreement with the findings of Jack et al.11 The estimated association suggests that increasing A  is associated with increased hazard of conversion up until a value of   ng/mL, after which hazard decreases. There was evidence that increased levels of p-tau were associated with increased hazard of conversion. Contrary to what we expected, having a mother or father with AD was suggestive of lower hazard of conversion to AD, although neither coefficient was statistically significant. Hippocampal volume was the strongest predictor of hazard (measured by statistical significance), with larger volumes associated with lower hazard of conversion. This is consistent with the findings of previous studies which have found that the hippocampus is one of the earliest structures of the brain to undergo atrophy during AD. 

Next, we used FCS MI to impute the partially observed baseline variables. 50 imputations were used. Continuous variables were imputed using linear regression models while binary variables were imputed using logistic regressions. To incorporate the censored time to conversion outcome we followed the recommendations of White and Royston16 and included the event indicator and marginal Nelson–Aalen cumulative hazard function as covariates in the imputation models. We passively imputed the A  term in the imputed datasets. The FCS estimate of A  is smaller in magnitude than the CC estimate (Table 5). This is consistent with the simulation results of Section 7.1, which showed that linear imputation of variables for substantive models which include quadratic effects of the variable leads to attenuation in the estimate of curvature. The coefficient for the linear A  term is also much smaller and no longer statistically significant. The estimated coefficient for p-tau is much smaller. The negative association between hippocampal volume and hazard of conversion remained. The coefficients for family history of AD changed by a proportionately large amount. Further investigation revealed that the dependence of hazard of conversion to AD on family history of AD varied (in a model without the CSF variables) according to whether or not the CSF variables were measured. This means that the assumption required for validity of complete case analysis failed for the reduced model without the CSF variables, and this is the likely cause of the large change in the coefficients for family history of AD. Standard errors were considerably smaller, consistent with the gain in information through inclusion of subjects with some missing values into the analysis.

Lastly, we imputed using SMC-FCS, again using 50 imputations, with 10 iterations per imputation. Here we assumed linear regression covariate models for partially observed continuous variables and logistic regressions for partially observed binary variables. Comparing the estimates from SMC-FCS with complete case and passive FCS, we see that the linear and quadratic coefficients of A  are much closer to the complete case estimates, with the statistical significance of the quadratic coefficient preserved (Table 5). The estimated coefficient for p-tau is similar to that obtained in the FCS analysis. For the other coefficients the SMC-FCS estimates and CIs are similar to those from FCS. In conclusion, consistent with our earlier simulation results, the results of this analysis suggest that ignoring the quadratic association at the imputation stage leads to attenuation in the corresponding coefficient. In contrast, imputation of the partially observed covariates using SMC-FCS preserved a quadratic association between CSF A  seen in the complete cases. Furthermore, use of MI has here led to practically important improvements in the precision of estimated associations, compared to CC.

9 MI of covariates in practice

Our developments thus far have assumed that at the imputation stage we have a single correctly specified substantive model  . Usually, we will not know in advance of analysing the data what is an appropriate model for the outcome Y of interest given the covariates. One of the apparent advantages of using MI is that once a set of imputed datasets have been generated, a number of different substantive models can be fitted and compared. It is important to note that the validity of estimates from different models fitted to a set of MIs depends on whether the imputation model is correctly specified. In practice, all imputation models are likely to be mis-specified to some extent, but biases may be small provided imputation models preserve those features of the data which are subsequently investigated. It is arguably therefore unrealistic in practice to expect a single set of multiply imputed datasets to be suitable for all possible subsequent types of analysis.

Performing model selection in combination with MI is a challenging problem generally,24 and therefore deciding on what substantive model to specify when using the SMC-FCS algorithm is not a trivial process. One possible approach would be to use the complete cases to select the substantive model. Alternatively, the SMC-FCS algorithm could be used to impute the partially observed covariates assuming a rich model for   which contains as special cases various simpler models that one may wish to fit to the imputed datasets. This approach would mean the imputation models used would be compatible with this larger model, and semi-compatible with those substantive models nested within it. This advice follows that given by others (e.g. Meng6 and Schafer7) for application of MI in general, whereby imputation models are used which are rich and do not impose assumptions which are subsequently to be relaxed in substantive models. For example, if one believes that two covariates may interact in their effect on Y, one could impute compatibly with a model   which includes the corresponding interaction.

We do not consider the requirement to specify a substantive model at the imputation stage to be a shortcoming of the SMC-FCS approach, since the issue of compatibility between imputation and substantive models is similarly present when one imputes using standard FCS MI. Indeed, whereas SMC-FCS forces the analyst to consider the issue of compatibility between these models, if using standard FCS MI one may unwittingly specify covariate imputation models which are incompatible with one’s substantive model.

As noted in Section 1, in many settings auxiliary variables V may be available, which although not involved in the substantive model, may be useful for inclusion in imputation models in order to improve efficiency (by virtue of their association with variables being imputed) or to increase the plausibility of the MAR assumption. The notion of compatibility between imputation and substantive models does not then apply, since the two models involve different sets of variables. However, one could include the auxiliary variables V as additional covariates in the model for Y in the SMC-FCS algorithm, following which models for Y can be fitted using the imputed datasets which omit V.

10 Discussion

MI is an attractive approach for handling missingness in covariates of regression models. When the substantive model contains non-linearities or interactions, existing imputation approaches using the FCS algorithm may give biased estimates because the imputation models are incompatible with the substantive model. Our proposed modification of the popular FCS approach to MI ensures that each covariate is imputed from a model which is compatible with the substantive model. Although compatibility does not guarantee the imputation models are correctly specified, it ensures that the imputation and substantive models do not make conflicting assumptions which may induce bias in parameter estimates. In our simulations across a range of settings we found SMC-FCS to generally outperform existing alternative imputation approaches.

In special cases, SMC-FCS is equivalent to imputation from a Bayesian joint model, and thus inherits the latter’s statistical properties. More generally, if the covariate models used in SMC-FCS are valid semi-compatible, we conjecture that the resulting estimator is consistent, which is supported by our simulation results. Further, in these cases CI coverage for estimates from SMC-FCS attained nominal coverage, despite the lack of equivalence to imputation from a Bayesian joint model. In simulations in which the covariate models were mis-specified, estimates from SMC-FCS were still less biased than those from what might be considered ‘standard FCS’.

For linear substantive models which contain non-linear covariate effects or interactions, the ‘JAV’ approach is attractive, and is consistent if data are MCAR. This holds irrespective of the joint distribution of the outcome and covariates. However when data are MAR, or for other substantive model types such as logistic regression, we and Seaman et al.10 have shown that JAV gives biased estimates. At least in our limited simulation study, the polynomial combination method recently proposed by van Buuren23 was superior to JAV, with less bias and coverage closer to the nominal level. A limitation of this approach however is that it only applies to imputation of covariates which have a quadratic association with outcome, and it is unclear whether it can be generalised to substantive models other than linear regression.

Relative to standard FCS MI, SMC-FCS is more computationally intensive because of the use of rejection sampling to sample from the required densities. For example, the SMC-FCS algorithm took six times longer than standard FCS to create 10 imputations for a simulated dataset from the first simulation scenario (linear regression with quadratic covariate effects). The acceptance rate of the rejection sampler will be low when the target density   differs substantially from the candidate density  . This will occur if a subject has an outcome value Y which is unlikely to have occurred given the values of   and Z. However, our experience thus far in simulation studies has been that this has not been an issue. Furthermore, as for standard FCS MI, additional work is needed to understand the statistical properties of the SMC-FCS algorithm. In some settings, substantive models may be fitted to imputed datasets for a number of different outcomes, and a limitation of our approach is that imputation models are defined with respect to a single (possibly multivariate) outcome variable.

We note that compatibility between imputation and substantive models is closely related to the concept of congeniality defined by Meng.6 We chose not to adopt this term because Meng’s definition of congeniality depends additionally on specification of incomplete and complete data ‘procedures’ which give asymptotically equivalent inferences to those under a Bayesian model. Further, in many cases SMC-FCS is not equivalent to imputation from a joint model, and so would not satisfy Meng’s definition of congeniality, which assumes imputation is from a well-defined Bayesian joint model. Lastly, the setup adopted by Meng assumed that covariates are fully observed.

In this article, we have assumed that the outcome is fully observed. In the absence of auxiliary variables subjects with missing outcome provide little or no additional information regarding the substantive model parameters,25 such that imputation of missing outcomes may not be beneficial. Nevertheless, the SMC-FCS algorithm can be readily extended to impute missing outcome values by imputing from the assumed substantive model.

A Stata program implementing SMC-FCS for linear, logistic and Cox proportional hazards models of interest is available for free download from www.missingdata.org.uk.

