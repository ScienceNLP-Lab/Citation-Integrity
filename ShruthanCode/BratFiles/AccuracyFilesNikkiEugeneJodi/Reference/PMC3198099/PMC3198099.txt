Artificial Pancreas: Past, Present, Future

The artificial pancreas (AP), known as closed-loop control of blood glucose in diabetes, is a system combining a glucose sensor, a control algorithm, and an insulin infusion device. AP developments can be traced back 50 years to when the possibility for external blood glucose regulation was established by studies in individuals with type 1 diabetes using intravenous glucose measurement and infusion of insulin and glucose. After the pioneering work by Kadish (1) in 1964, expectations for effectively closing the loop were inspired by the nearly simultaneous work of five teams reporting closed-loop control results between 1974 and 1978: Albisser et al. (2), Pfeiffer et al. (3), Mirouze et al. (4), Kraegen et al. (5), and Shichiri et al. (6). In 1977, one of these realizations (3) resulted in the first commercial device—the Biostator (7; Fig. 1), followed by another inpatient system, the Nikkiso STG-22 Blood Glucose Controller, now in use in Japan (8).

 The Biostator (courtesy of William Clarke, University of Virginia).  

Although the intravenous route of glucose sensing and insulin infusion is unsuitable for outpatient use, these devices proved the feasibility of external glucose control and stimulated further technology development. Figure 2 presents key milestones in the timeline of AP progress.

 Key milestones in the timeline of AP progress. EU, Europe; IP, intraperitoneal; NIH, National Institutes of Health; SC, subcutaneous.  

In 1979, landmark studies by Pickup et al. (9) and Tamborlane et al. (10) showed that the subcutaneous route was feasible for continuous insulin delivery. Three years later, Shichiri et al. (11) tested a prototype of a wearable AP, which was further developed in subsequent studies (12,13). In the late 1980s, an implantable system was introduced using intravenous glucose sensing and intraperitoneal insulin infusion (14). This technology was further developed, leading to clinical trials and long-term use (15,16); however, its clinical application remained limited because of the extensive surgical procedures needed for sensor and pump implantation.

In all early intravenous and intraperitoneal AP systems, the closed-loop control algorithms belonged to a class known as proportional-derivative controllers, which used blood glucose values and blood glucose rate of change in a relatively straightforward calculation of insulin dose. However, as it is explained later in this article, proportional-derivative control and its enhanced version, proportional-integral-derivative control, have inherent limitations that hinder their use in subcutaneous systems because of unavoidable time lags in subcutaneous glucose sensing and insulin action. Newer controllers, known as model-predictive control (MPC), avoid these limitations by using a mathematical model of the metabolic system of the person being controlled in their calculations. Many of these MPC algorithms are based on another 1979 milestone, the Minimal Model of Glucose Kinetics (17). Thus, since the early years of AP development, glucose sensing and insulin delivery technologies were accompanied by computer modeling and simulation (18–22). Review of methods for glucose control prior to 2000 can be found in two concurrent papers (23,24).

The new wave—subcutaneous AP—developed after minimally invasive subcutaneous glucose sensing was commercially introduced in 1999 by the MiniMed continuous glucose monitoring (CGM) system. This set off an accelerating academic and industrial effort focused on the development of a subcutaneous-subcutaneous system (Fig. 2). The MiniMed (later, Medtronic) closed-loop project was the first to provide evidence for the feasibility of the subcutaneous-subcutaneous route for fully automated blood glucose control in type 1 diabetic patients (25). The 3-year ADICOL project funded by the European Commission showed the feasibility of using advanced MPC strategies to close the loop (26). In September 2006, the Juvenile Diabetes Research Foundation International (JDRF) initiated the Artificial Pancreas Project and funded a consortium of centers to carry out closed-loop control research. So far, encouraging results have been reported by several centers (27–31). Two notable achievements were the acceptance by the Food and Drug Administration of the University of Virginia–University of Padova type 1 diabetes simulator as a substitute to animal trials in the preclinical testing of closed-loop control strategies (32), and the design by a team from the University of California Santa Barbara and the Sansum Diabetes Research Institute of a communication platform allowing the automated transfer of data between CGM, control algorithm, and insulin pump (33). Following these developments, JDRF initiated a now-ongoing multicenter, multinational trial in adults and adolescents with type 1 diabetes. Additional momentum was brought by the U.S. National Institutes of Health (NIH) funding several AP projects in 2009 and by the European Commission launching the AP@Home project in 2010, which involves seven universities and five companies throughout Europe. In the wake of these rapid developments, this article aims to identify critical problems in AP development and to outline possible solutions and a pathway toward the clinical acceptance of ambulatory closed-loop control.

Limitations of current glucose sensors

CGM technology was introduced 10 years ago, initially as a method for retrospective review of glucose profiles (34–36). Shortly after, real-time devices came about, providing online glucose readings (37). These first devices had limited performance, particularly in the hypoglycemic range (36,38,39). Since then, significant progress has been made toward versatile and reliable CGM; a number of studies have documented its benefits (40–42) and charted guidelines for its clinical use (43,44). Because CGM data are the input to the AP control algorithm, understanding of the physical, biochemical, and mathematical principles and limitations of this technology is critical (45,46).

First, most of the commercial subcutaneous CGM devices measure glucose concentration in a different than blood compartment—the interstitium. However, during rapidly changing conditions, e.g., after a meal or during a hypoglycemic episode, interstitial glucose and blood glucose can be markedly different (47–49). Thus, CGM devices require calibration using one or more daily blood glucose samples. The influence on CGM accuracy of the number and timing of calibration points was assessed by several studies (50,51). In particular, the DirecNet Study Group (52) analyzed changes in accuracy by modifying the calibration retrospectively and showed that calibrating during periods of relative glucose stability significantly improves CGM accuracy. Modern calibration procedures were suggested, based on mathematical models of interstitial glucose kinetics (53,54).

Second, time lag exists because of blood-to-interstitial glucose transport and the sensor processing time (instrument delay). Because such a time lag could greatly influence the accuracy of CGM (55,56), a number of studies were dedicated to its investigation (57–61). In most studies CGM readings lagged blood glucose (most of the time) by 4–10 min, regardless of the direction of blood glucose change, but the formulation of the push-pull phenomenon brought arguments for a more complex relationship than a constant time lag (60). For the purpose of closed-loop control, mitigation of the time lag was suggested based on near-term glucose forecast methods (51,61).

Third, errors from transient loss of sensitivity, and random noise confound CGM data (62–64). Thus, filtering, denoising, and artifact rejection in CGM data are important for closed-loop control. Algorithms performing these tasks are available in commercial CGM devices (65–67). The precise tuning of filter parameters in an automatic manner is, however, a difficult problem. Advanced methods that can be used to resolve this challenge have been recently reported (50,53,68–70).

Despite of their inherent limitations, CGM devices produce rich frequently-sampled data sets (e.g., every 5–10 min) allowing them to serve as AP-enabling technology (43,45). First steps from simple monitoring to control have already been taken; modern CGM devices display trends and blood glucose rate of change and are capable of alerting the patient about upcoming hypo- or hyperglycemia (71–73). Studies of the utility of such alerts have been initiated (73–75), and the next logical step—prevention of hypoglycemia via shutoff of the insulin pump—has been taken (76).

Limitations of insulin delivery

Because of its pharmacokinetic and pharmacodynamic advantages, the intravenous route of insulin delivery has been tested for ambulatory use with implantable devices from the 1970s to the early 1990s (77,78). However, despite their effectiveness, the limitations caused by recurrent catheter complications due to blood clotting stopped the development of this route of insulin delivery (79). An alternative approach to staying close to physiology is to use intraperitoneal insulin delivery, e.g., insulin infusion via the portal venous system (80–83). In view of closed-loop glucose control, the intraperitoneal infusion route has several intriguing characteristics: reproducibility of insulin absorption combined with quick time to peak and return to baseline, close-to-physiological peripheral plasma insulin levels, and restoration of glucagon response to hypoglycemia and exercise (84–86). Although the experience of implantable programmable insulin pumps from the 1990s has highlighted their benefits including sustained improvement in mean blood glucose and reductions in glucose variability and severe hypoglycemia (87–90), the clinical use of these devices has been limited because of insulin aggregation issues (91), increased production of anti-insulin antibodies, which impair insulin action in some patients (92,93), and the cost associated with this technology. Still, the development of less invasive and cheaper implantable ports for intraperitoneal insulin delivery (e.g., DiaPort; Roche Diagnostics, Mannheim, Germany) may extend this option of insulin infusion in view of an AP (94).

Since the late 1990s, continuous subcutaneous insulin infusion (CSII) has become an accepted mode of insulin pump therapy (95). Improvements in safety, miniaturization, refined tuning of insulin pumps allowing for fine adjustments of basal rate, the recently introduced “patch pumps” (96), and new insulin analogs (97,98), all lead to improved patient comfort and better glucose control. The key issue of subcutaneous insulin delivery remains the delay in action caused by the time needed for subcutaneous absorption, resulting in late insulin peaks up to 120 min after the injection of a subcutaneous bolus of regular insulin (95). Moreover, with subcutaneous insulin delivery the lost physiological role of the liver in modulating peripheral insulin levels results in higher peripheral insulinemia (82). Whether such a reduced hepatic insulinization impairs the control of hepatic glucose output significantly is still unclear. In terms of safety, altered absorption at the subcutaneous delivery site has been pointed out as a risk for insulin underdelivery—a major issue observed with CSII, which may result in ketoacidosis if undetected and not corrected in time (77,99). This phenomenon has been shown to occur even more rapidly with the use of fast-acting analogs (100).

In an AP setting, CSII combined with subcutaneous glucose sensing has been shown to be effective for “out-of-meal” periods, keeping blood glucose in the normal range in the postabsorptive state (26,45). However, fully automated closed-loop control has not been so successful in addressing insulin needs at meals (25,26). Indeed, the rapid rise of postmeal glucose is difficult to avert because of the inherent delays in subcutaneous insulin absorption and action (101). As a result, all AP trials reported to date show a significant postprandial glucose peak above the normal range. Moreover, delayed insulin action while postprandial blood glucose decreases may result in secondary glucose lows a few hours after the meal (26).

Need for “smart” control algorithms

Despite important developments in sensor and pump technology, the AP must cope with the delays and inaccuracies in both glucose sensing and insulin delivery described in the previous sections. This is particularly difficult when a system disturbance, e.g., a meal, occurs and triggers a rapid glucose rise that is substantially faster than the time needed for insulin absorption and action (Fig. 3).

The problem is that with inherent delays, any attempt to speed up the responsiveness of the closed loop may result in unstable system behavior and system oscillation. Thus, a sound controller design must consider a relatively slow response, giving time for the delays to wear off before the next control action. However, a slow response cannot provide good attenuation of postprandial glucose peaks. Hence the principal AP control dilemma: find a trade-off between slow-pace regulation well suited to mild control actions applicable to quasi-steady state (e.g., overnight), and postprandial regulation calling for prompt and energetic corrections (102,103).

Historically, this problem was clearly demonstrated by the first closed-loop experiments that used PID algorithms. Because PID is purely reactive, responding to changes in glucose concentration after they have occurred, it suffers most from the problems described above. In particular, to avoid hypoglycemia after a meal, one has to design a moderately aggressive controller; however, such a “cautious” design would not react promptly and effectively to meals. To improve PID performance, one possibility is to add a feed-forward action (a regular premeal bolus), which helps with meal compensation as demonstrated in clinical studies (27). To mitigate hypoglycemic events, an insulin negative feedback on insulin delivery rate has also been introduced (104).

The new wave of control designs, MPC, is based on prediction of glucose dynamics using a model of the patient metabolic system and, as a result, appears better suited for mitigation of time delays due to subcutaneous glucose sensing and insulin infusion. In addition, MPC is a better platform for incorporation of predictions of the effects of meals and for introduction of constraints on insulin delivery rate and glucose values that safeguard against insulin overdose or extreme blood glucose fluctuations. In some sense, an MPC algorithm works as a chess strategy (Fig. 4). On the basis of past game (glucose) history, a several-moves-ahead strategy (insulin infusion rate) is planned, but only the first move (e.g., the next 15-min insulin infusion) is implemented; after the response of the opponent, the strategy is reassessed, but only the second move (the 30-min insulin infusion rate) is implemented, and so on. In reality glucose prediction may be different from the actual glucose measurement or an unexpected event may happen; with this strategy these events are taken into account in the next plan.

Several successful clinical trials using MPC were recently published. Kovatchev et al. (31) reported a study in which the aggressiveness of the controller was individualized using patient parameters such as body weight, carbohydrate ratio, and insulin basal rate. Hovorka et al. (28) used a multimodel MPC approach, deciding in real time which patient model is best fitting the data in hand, while dual-hormone strategies adding glucagon administration to insulin delivery to avoid hypoglycemia were used by El-Khatib et al. (30) and Castle et al. (105).

Additional difficulties that the control algorithm must face arise from coping with inter- and intrapatient variability. Fortunately, MPC allows for relatively straightforward individualization using patient-specific model parameters (106). Given the difficulty of identifying accurate individual models, a customizable controller has been proposed, individually tuned through a “control aggressiveness” parameter calculated from a few routine biometric and clinical data of each individual (107). In addition, MPC can have “learning” capabilities; it has been shown that a class of algorithms (known as run-to-run control) can “learn” specifics of patients’ daily routine (e.g., timing of meals) and then optimize the response to a subsequent meal using this information (108,109), or account for circadian fluctuation in insulin resistance, such as the dawn phenomenon observed in some people (110).

Finally, an MPC system can also have certain feed-forward capabilities, i.e., the ability to use a combination of feed-forward (e.g., patient-initiated) and feedback (controller-initiated) insulin delivery that can partially solve the dilemma posed by the need for trade-off between slow-pace regulation in quasi-steady state and prompt correction of meals. Associated with such a feed-forward action is a nominal glucose profile, which represents the expected consequence of the conventional patient-initiated therapy. The algorithm bases its actions on the difference between the sensor signal and this nominal profile. If the difference is zero, no closed-loop correction is applied and the patient is subject to the conventional therapy alone. In practice the difference will always be nonzero, thus a feed-forward action would also prompt small-size feedback corrections adapting to unpredicted events, disturbances and changes in patient’s dynamics. Clinical results obtained by this type of control strategy are reported by Kovatchev et al. (31).

A step forward: in silico experiments replacing animal trials

The future development of AP will be greatly accelerated by using mathematical modeling and computer simulation. A number of simulation models have been proposed in the last 4 decades and used to assess the performance of control algorithms and insulin infusion routes (111–117). However, all these models are “average,” meaning that they are only able to simulate average population dynamics but not the interindividual variability. The average-model approach is not sufficient for realistic in silico experimentation with control scenarios. For this purpose, it is necessary to have a simulator equipped with a cohort of in silico subjects that spans sufficiently well the observed interperson variability of key metabolic parameters in the type 1 diabetic population. The knowledge on intersubject variability is indeed crucial to the design of robust controllers, providing valuable information about their safety and limitations.

Building on the large scale meal model developed in the healthy state (116,117), we have developed a type 1 diabetes simulator that, thanks to its ability to realistically describe intersubject variability, has been accepted by the Food and Drug Administration as a substitute of preclinical animal trials for certain insulin treatments (32). In this simulator, a virtual human is described as a combination of several glucose and insulin subsystems. To permit in silico experiments using CGM, the model includes subcutaneous glucose transport and sensor errors. In summary, the model consists of 13 differential equations and 35 parameters for each subject (116,117). The simulator is equipped with 100 virtual adults, 100 adolescents, and 100 children, spanning the variability of type 1 diabetic population observed in vivo. Key “biometric” characteristics of these virtual subjects are presented by Kovatchev et al. (32). Figure 5 illustrates the overall design of the simulation model.

With this technology, any meal and insulin delivery scenario can be pilot-tested very efficiently in silico, prior to its clinical application. Because in silico experiments produce results at a fraction of time and cost of animal trials, this simulator in now adopted by the JDRF Artificial Pancreas Consortium and by others as a primary test bed for new closed-loop control algorithms. The capabilities of the simulator are now being expanded by incorporating intraday variability of key fluxes (e.g., glucose production) and signals (e.g., insulin sensitivity [118]), and by including hypoglycemia counterregulation (119).

Modular Architecture for Sequential AP Development

Today’s technological advancements open the possibility for ambulatory AP. To account for the multitude of available possibilities, academic, and industrial developments, we have introduced the concept of modular approach to AP design, which allows technologies developed by different entities to be seamlessly integrated in a functional hierarchical system that can be sequentially deployed in clinical and ambulatory studies. Figure 6 presents an outline of this modular-architecture concept.

The key advantage of modular AP architecture is the possibility for sequential development, clinical testing, and ambulatory acceptance of elements (modules) of the closed-loop system. In engineering terms, we suggest that the AP should have separate interacting components responsible for prevention of hypoglycemia, postprandial insulin correction boluses, basal rate control, and administration of premeal boluses (120). In this scheme, control modules receive information from system state estimation modules that are responsible for tracking glucose fluctuations and the amount of active insulin at any point in time. This structure is dictated by the natural separation of the computational elements of a closed-loop control system into algorithms estimating the state of the person and algorithms actuating control. The control layers work on different time scales. At the bottom, the fastest layer is in charge of safety requirements. Possible algorithms include pump shutoff (76), insulin on board, and smooth attenuation of the insulin pump (121). Immediately above, there is the real-time control layer deciding insulin delivery based on latest CGM data, previous insulin delivery, and meal information. Typical algorithms are either PID, MPC, or the recently introduced Zone MPC controller (122). The top layer (offline control tuning) is in charge of tuning the real-time control layer using clinical parameters and historical data. Each layer processes available information (CGM and patient inputs) in order to take decisions that are passed to a lower layer. If necessary, commands from an upper layer can be overridden; a typical example is the safety layer canceling insulin delivery suggested by the real-time control module.

With modular architecture in place, various increasingly complex configurations of an AP system become possible. For example, a relatively simple control system responsible only for nighttime basal rate regulation has been successfully tested as a first step to AP (31), followed by control of risk for hypoglycemia associated with exercise (123). More recently, a new modular control-to-range algorithm has been introduced as an adjunct to, not a replacement of, standard basal-bolus pump therapy, intervening only if corrections of hypo- or hyperglycemia are needed (120). This control strategy resulted in reduced average glucose without increasing patients’ risk for hypoglycemia (124).

Further, the progression of AP would entail moving the system to outpatient setting. This critical step would require specific elements, such as server and communication tools for remote monitoring but also for remote intervention. Remote monitoring would be particularly important for the first ambulatory clinical trials that would require continuous “intelligent” observation of AP first deployed outside of the hospital. From there, step-by-step move to home use would follow module-by-module approach under remote monitoring. Finally, fully automated closed-loop is expected to deliver safe and efficacious glucose control at home for a prolonged period of time. To cope with the changing environmental conditions and with the physiological/behavioral changes of the patient, the ambulatory AP will have to adapt to the changes in an individual’s biobehavioral parameters over time. Possible methods to cope with changing reality include individual controller calibration strategies and run-to-run control algorithms (107–110), as well as behavioral analysis and profiling of patient lifestyle (125). Many of these advanced methods are now on the drawing board. Table 1 summarizes the principal components of a closed-loop system, including the CGM, the insulin infusion device, the control algorithm and the associated human factors, and lists the areas that need further development before the ambulatory AP becomes a reality.

FIG. 1.

The Biostator (courtesy of William Clarke, University of Virginia).

FIG. 2.

Key milestones in the timeline of AP progress. EU, Europe; IP, intraperitoneal; NIH, National Institutes of Health; SC, subcutaneous.

FIG. 3.

Block diagram of closed-loop glucose control. Three major delays are indicated: insulin absorption (regular and ultrafast insulin), insulin action on peripheral tissues and on the liver, and sensing in the interstitium.

FIG. 4.

A: The concept of MPC. At each step, future glucose levels are predicted and insulin delivery strategy is mapped several steps ahead. Then, the first insulin delivery step is implemented, and the situation is reassessed with new glucose data. The process is very similar to a chess game in which several moves are planned ahead, and after the implementation of the first move the position is reassessed given the response of the opponent. B: The critical stage of the famous chess game between Leonid Stein (white) and Lajos Portisch (black), Stockholm, 1962 (courtesy of Leon Fahri, University of Virginia).

FIG. 5.

Principal component of the type 1 diabetes simulator: a model of the glucose-insulin system, a model of the sensor, a model of the insulin pump and subcutaneous insulin kinetics, and the controller to be tested.

FIG. 6.

Modular architecture for sequential AP development.

