Clinical Evaluation of a Personalized Artificial Pancreas

Abstract

OBJECTIVE

An artificial pancreas (AP) that automatically regulates blood glucose would greatly improve the lives of individuals with diabetes. Such a device would prevent hypo- and hyperglycemia along with associated long- and short-term complications as well as ease some of the day-to-day burden of frequent blood glucose measurements and insulin administration.

RESEARCH DESIGN AND METHODS

We conducted a pilot clinical trial evaluating an individualized, fully automated AP using commercial devices. Two trials (n = 22, n  = 17) were conducted using a multiparametric formulation of model predictive control and an insulin-on-board algorithm such that the control algorithm, or “brain,” can be embedded on a chip as part of a future mobile device. The protocol evaluated the control algorithm for three main challenges: 1) normalizing glycemia from various initial glucose levels, 2) maintaining euglycemia, and 3) overcoming an unannounced meal of 30 ± 5 g carbohydrates.

RESULTS

Initial glucose values ranged from 84–251 mg/dL. Blood glucose was kept in the near-normal range (80–180 mg/dL) for an average of 70% of the trial time. The low and high blood glucose indices were 0.34 and 5.1, respectively.

CONCLUSIONS

These encouraging short-term results reveal the ability of a control algorithm tailored to an individual’s glucose characteristics to successfully regulate glycemia, even when faced with unannounced meals or initial hyperglycemia. To our knowledge, this represents the first truly fully automated multiparametric model predictive control algorithm with insulin-on-board that does not rely on user intervention to regulate blood glucose in individuals with type 1 diabetes.

Type 1 diabetes is a chronic disease that requires constant vigilance for successful glucose control. Chronic elevation or fluctuations in blood glucose may result in a number of long-term complications (blindness, kidney failure, heart disease, stroke, and lower-extremity amputations). Conversely, attempts to aggressively normalize glucose concentrations increase the risk of severe hypoglycemia. Despite the introduction of continuous subcutaneous insulin infusion (CSII) pumps and programs that promote intensive diabetes management, the glycosylated hemoglobin, an indicator of long-term blood glucose control reported by major diabetes treatment centers, remains >8% (1). This value is well above the current recommended goal of <7% set forth by the American Diabetes Association or <6.5% recommended by the American Association of Clinical Endocrinologists (1). Many factors contribute to this failure, including the following: 1) difficulties in correctly estimating the amount of carbohydrates in a meal, 2) missed meal boluses, and 3) fear of hypoglycemia that results in underinsulinization, especially overnight. As long as diabetes treatment demands constant direct intervention, the majority of individuals with diabetes will not meet the established goals.

An artificial pancreas (AP) that can control blood glucose without patient intervention before meals or physical activity may be an intermediate solution until a cure for type 1 diabetes is discovered. By removing active patient participation from the loop, a fully automated AP would allow individuals with type 1 diabetes to go about their activities without the need to check their blood glucose, count carbohydrates, and take insulin injections multiple times a day. The AP comprises three main components: a continuous subcutaneous glucose monitor (CGM), a CSII, and a mathematical control algorithm that processes data from the glucose sensor and implements insulin delivery. In fact, initial studies of APs have demonstrated that subcutaneous sensors controlling CSII pumps using a control algorithm can regulate blood glucose in subjects with type 1 diabetes in carefully controlled research settings (2–10).

There are multiple challenges to optimizing this system, including the following: 1) the accuracy and precision of the CGM; 2) time lags in interstitial glucose measurements, especially when there are rapid changes in the glucose concentrations; 3) delays in the onset of insulin action after a subcutaneous injection; and 4) prolonged insulin action of 4–6 h following a subcutaneous injection. A subcutaneous-subcutaneous AP, therefore, cannot fully mimic normal β-cell function, but initial studies indicate that it would better maintain diabetes control than current open-loop methods.

Control algorithms, such as those used to determine insulin delivery, usually are designed and tuned on the basis of a mathematical model of the underlying system. Models can range from simple (rules describing whether an input increases or decreases the output) to complex (sets of nonlinear partial differential equations detailing physiology). These diverse modeling approaches consider trade-offs between ease of design and implementation and quality of performance. In recent years, attempts were made to design an AP system using various control algorithms (11) from a simple proportional-integral-derivative control approach, as demonstrated by Steil et al. (12) and Castle et al. (9), to a fuzzy logic approach aimed at imitating the decision-making process of a trained physician, as published by Atlas et al. (3). However, the control approach that seems to be most advantageous and has been widely used in recent years is model predictive control (MPC), which Parker et al. (13) first published for glucose control. The advantage of an MPC strategy is its ability to incorporate an explicit model of the glucose-insulin system. The controller compares the model-predicted output with the actual output (glucose concentration), calculates the next manipulated input value (insulin delivery), and updates the prediction with new measurements at each control cycle.

Recent publications have demonstrated the use of MPC to manage blood glucose in single-hormone closed-loop trials of up to 24 h, with encouraging results (4,7,14–16). Other studies have used a dual-hormone approach to mimic normal physiology and reduce the likelihood of postprandial hypoglycemia because of excessive insulin administration (6,9). However, none of these studies presented a design that had both control and safety algorithms and could operate as an autonomous system. Either a manual glucose reading from the CGM, manual administration of insulin by the study personnel, or both was used (4,6,9,14,15), or a three-pump system with manual venous blood glucose input was implemented (6). Atlas et al. (3) contributed an AP design that relied on the subject’s clinical parameters and medical recommendation but lacked a safety module to prevent overdosing of insulin. Insulin was delivered without human intervention in Atlas et al.; specifically, they used the Artificial Pancreas System (APS) to facilitate communication (17). The need for both a systematic design of the AP and the inclusion of more than one algorithm to provide safe, effective glycemic control has been recognized by Kovatchev et al. (18). The AP that was clinically evaluated in the studies presented here was the first fully automated AP to integrate both a multiparametric MPC (mpMPC) algorithm that can be easily embedded in a chip and a safety layer that prevents overdelivery of insulin. The objective of the present study was to demonstrate the feasibility of a system that would not require user input for meals and would be based solely on insulin delivery (19,20).

RESEARCH DESIGN AND METHODS

The studies were designed as pilot prospective trials to evaluate a fully automated design of an AP based on an mpMPC with insulin-on-board (mpMPC-IOB) control algorithm. The study was exploratory, allowing subjects to come into the trial in real-life settings without excessive control beforehand. This allowed the controller to be challenged with a variety of likely starting points. Flexibility during initialization of closed-loop control will be a critical element in future commercial devices. Seventeen subjects with type 1 diabetes were recruited for the study: 7 from The National Center for Childhood Diabetes of Schneider Children’s Medical Center of Israel (SCMC) and 10 from the Sansum Diabetes Research Institute (SDRI). Twenty-two in-clinic closed-loop trials were conducted at SCMC and SDRI. Four studies from SCMC were excluded because of hardware failure or lack of reference blood glucose data. Fifteen subjects (7 males and 8 females) with type 1 diabetes for 8–18 years participated in the remaining 18 studies: 10 subjects at SDRI and 3 at SCMC were in a single study, and 2 at SCMC were in multiple studies. Detailed results of each study are presented in Table 1, including demographic information and clinical characteristics. The average duration of the 18 studies was 6.3 h (range 3.4–8.3 h). The study was approved by the SCMC ethics committee for the SCMC studies and by both the Food and Drug Administration (through an investigational device exemption [#G090129]) and the Santa Barbara Cottage Hospital’s Institutional Review Board for the SDRI studies. All subjects listed in Table 1 signed an institutional review board-approved informed consent form; the subject’s height and weight as well as demographic data, diabetes history, and other significant medical history were recorded. Inclusion criteria were a minimum age of 18 (SCMC) and 21 (SDRI) years, disease duration of at least 1 year, and treatment with an insulin pump for at least 6 months. Patients with a concomitant disease affecting metabolic control or who had participated in another study for drugs that could affect glucose measurements or glucose management were excluded.

Closed-loop system

Communication among the CGM sensor, the CSII pump, and the mathematical algorithm was conducted using the APS (17) to allow for flexible incorporation of the control algorithm under investigation and fully automated closed-loop studies using commercial CGMs and commercial or modified CSIIs. The system runs within a MATLAB (The MathWorks, Inc., Natick, MA) environment on a host computer. In this study, the components were used as follows: 1) interstitial glucose concentrations were measured using unmodified, Food and Drug Administration–approved STS SEVEN and SEVEN PLUS (Dexcom, Inc., San Diego, CA) CGMs; 2) insulin was administered by a modified Insulet personal diabetes manager and a commercial OmniPod (Insulet, Bedford, MA); 3) APS versions 2.5, 2.6, and 2.9 were used during the in-clinic closed-loop trials; 4) reference intravenous blood glucose levels were measured by the YSI 2300 STAT Plus (YSI, Inc./Xylem Inc., Yellow Springs, OH) every 30 min; and 5) a short-acting insulin analog (NovoRapid; Novo Nordisk, Bagsværd, Denmark) was used in the clinical trials.

Personalized controller design

The MPC algorithm used for the clinical studies (13) incorporated an explicit model of human type 1 diabetes glucose-insulin dynamics. MPC is a receding horizon control strategy in which an optimization is performed at each time step. If the optimization problem includes constraints, an iterative solver must be used to find the optimal solution. Multiparametric programming allowed for the reformulation of the MPC problem into an explicit form (21,22) where a single set of optimizations can be performed a priori. The resulting control law was implemented in the form of a look-up table, with each entry valid for a region in the state-space representing the current state of the system. Each entry corresponded to a simple function that evaluated the state vector and calculated the optimal insulin delivery rate. The single degree of freedom for controller tuning was the ratio of the tracking error to the control move, which was set to 0.1 for all subjects. Software constraints ensured that insulin delivery rates were bound between 0 and 72 U/h. At each time step, glucose prediction for the next 36 steps and the insulin infusion rates for the next 6 time steps were calculated. Then, the insulin infusion for the current time step was implemented. At the next time step, on the basis of the new measured glucose value and the last insulin rate, the process was repeated. An IOB safety constraint presented by Ellingsen et al. (23) was implemented as an upper limit on the insulin delivery rate to prevent insulin stacking. This maximum insulin delivery rate was calculated on the basis of nonlinear IOB decay curves (24) and the subject’s correction factor (CF).

Before the closed-loop trial was initiated, the look-up table for the control law was developed in several stages. The subject first underwent open-loop monitoring for 3 consecutive days before the closed-loop session, during which CGM measurements, insulin delivery rates, blood glucose, physical activity, and carbohydrate consumption were recorded. The data and corresponding insulin profiles from the patient’s insulin pump were used as a basis for developing individual models for the closed-loop controller. These models were then evaluated based on physiological knowledge of acceptable parameter ranges. The best model was chosen based on root-mean-square error analysis of independent validation data. This model was used in the mpMPC algorithm (22,25–28).

In-clinic schedule

Two CGMs were inserted 1–2 days before the in-clinic day. On the in-clinic day, subjects were admitted at 7:00   in a fasting condition with no food after 10:00  , unless needed to treat hypoglycemia (glucose <70 mg/dL), and no extra bolus insulin after 3:00  . An unannounced meal challenge was given if the glucose level was maintained in the target range for at least 40 min. At admission, the subject’s insulin pump was removed and replaced with an OmniPod system that was connected to the APS. One CGM was connected to the APS, and the second one was used only if the primary device failed during the study. The clinical protocol evaluated the control algorithm for three main challenges: 1) normalizing glycemia from different starting points at the near-normal range to mild hyperglycemia, 2) maintaining euglycemia at a target of 110 ± 30 mg/dL, and 3) overcoming an unannounced meal of 30 ± 5 g carbohydrates. The trial was concluded when either challenge 1 and challenge 2 or all three challenges were addressed, resulting in varied trial duration among the cohort.

RESULTS

Eighteen fully automated closed-loop control sessions testing this AP design using MPC were conducted at SCMC and SDRI with no clinically adverse events. Summaries of all the clinical trials are shown in Fig. 2 and Table 1, with detailed CGM, YSI, and insulin results for all studies shown in Supplementary Figs. 1–18.

Representative examples of two of the closed-loop studies with unannounced meals are presented in Fig. 1A (study number 15) and B (study number 10) with glucose concentrations (CGM, YSI, and finger sticks) in mg/dL presented in the upper panels and controller insulin suggestion in the lower panels. On the right side of each main panel, a pie chart shows the time in various glucose ranges based on CGM (A1 and B1) and YSI (A2 and B2) measurements during the closed-loop. Initial start-up conditions for each subject varied as a reflection of daily glucose variability among subjects, for example, recovery from hyperglycemia for the subject in Fig. 1B and in-target glucose level for the subject in Fig. 1A. Time spent in the tight range of 80–140 mg/dL was 54.5 and 64.3% (as measured by YSI) in Fig. 1A and B, respectively. Both subjects in Fig. 1 had a low blood glucose index (LBGI) of 0 and high blood glucose index (HBGI) (29) of <4, as illustrated in Table 1.

One of the main challenges of the closed-loop design of an AP is to maintain glycemia in the near-normal range (80–180 mg/dL) when faced with unannounced meals and without significant hypo- or hyperglycemia. Traditionally, the analysis of results is mainly based on reference blood glucose (e.g., YSI) to review the clinical application and performance of closed-loop control. However, one should also review and analyze CGM results to obtain a better understanding of closed-loop control performance that can be achieved with current CGMs. Figure 2 shows the average and absolute maximum and minimum cumulative time in range in outpatient versus closed-loop CGM data (Fig. 2A and B) and closed-loop CGM versus closed-loop YSI data (Fig. 2C and D). The degree to which the envelopes in Fig. 2A and C lie between 80–180 mg/dL indicates how much time was spent in range overall. The average time as measured by YSI spent in the tight and near-normal ranges for all trials was 36 and 70%, respectively (Fig. 2D), with no values <70 mg/dL.

A detailed analysis of the glucose concentration distribution from both outpatient and inpatient CGM data (Fig. 2B) provides statistical evidence (P < 0.05) that closed-loop control minimized hypoglycemia (<70 mg/dL), improved the time in the near-normal range (140–180 mg/dL), and reduced the time in severe hyperglycemia (>250 mg/dL), even though the sedentary inpatient conditions limited insulin utilization. It should be noted that meal sizes in the outpatient setting were similar to the inpatient setting, with 81 and 70% of the outpatient meals <50 and <40 g carbohydrates, respectively. Comparing CGM to YSI results in Fig. 2C, the time in the 80–250 mg/dL range was almost identical, whereas in the low and high ranges, CGM values were not in absolute agreement with the reference results (mean and median absolute relative deviations 13.3 and 9.9%, respectively). Overall, although no statistical significance can be derived from this comparison, the results suggest that current CGM technology can be used for a fully automated AP when a safety algorithm such as IOB is used to prevent overdelivery of insulin. The controller maintained glycemia in the safe range (80–180 mg/dL) for an average 68 and 70% of the time under closed-loop control according to the CGM and YSI data, respectively. No hypoglycemia episodes were reported by YSI, and glucose levels of <70 mg/dL were reported only 2% of the time by CGM. Moderate postprandial hyperglycemia was reported by YSI in only two trials, with postprandial peaks of 251 and 263 mg/dL.

As shown in Table 1, the mean LBGI and HBGI were, respectively, 0 and 5 by YSI and 0.6 and 5.4 by CGM. Control variability grid analysis (CVGA) (30) provides detailed results of the closed-loop performance in terms of ability to avoid both hypo- and hyperglycemia as presented over nine categories (Table 1 and Fig. 3). The CVGA results of all closed-loop trials were in the A and B zones as measured by YSI, which suggest excellent control. It is important to indicate that these results represent the entire duration of the trial, including initial and postprandial glucose levels. As can be noted in Table 1, in three trials, the results of the CVGA based on CGM measurement were in the lower D zone, suggesting failure to manage hypoglycemia; however, no glucose values <70 mg/dL were recorded by YSI.

Two subjects repeated the study more than once with minimal intrasubject variability, showing the robustness of the system. Subject 2 repeated the study three times (studies 2–4). In none of these instances did the subject experience hypoglycemia. In two studies, they had relatively short duration (∼4 h) and had a majority of YSI and CGM values in the 140–250 mg/dL range. In the third study, the duration was 6 h, and the subject had a majority of values in the 80–180 mg/dL range. CVGA results were in the upper B or A regions for all three studies. Subject 3 repeated the study twice (studies 5 and 8). This subject had very similar duration and results for both studies, with CVGA results in the B region (see Table 1 for detailed results).

CONCLUSIONS

We have demonstrated in this short-term pilot evaluation that a fully automated AP device based on personalized MPC with safety components is capable of controlling glycemia by delivering only insulin without postprandial hypoglycemia. Good glucose control with 70% of the time in the near-normal range (80–180 mg/dL) was demonstrated in the face of daily challenges, such as starting closed-loop control at different glucose values, overcoming small unannounced meals, and hyperglycemia in addition to the constraint of maintaining glucose control in the near-normal range. Although the duration of the trials after meals was relatively short (∼2 h), no subsequent hypoglycemia was observed, as can be seen in the insulin and glucose tracings in Supplementary Figs. 1–18 and Table 1. Two cases (5 and 11) had a negative rate of fall as measured by the CGM at the end of the study, suggesting an impending trend toward hypoglycemia. The risk of late (poststudy protocol) hypoglycemia could not be completely avoided but was addressed by the protocol, which required the subject to eat a snack and exhibit glucose values ≥90 mg/dL before release followed by a callback on the next day. In all cases, no significant hypoglycemia episodes were reported during the callback. Meal corrections were given by the controller based on the glycemic state, with postprandial delivery equaling 0.2–1.4 times the insulin expected if using conventional therapy, although it is recognized that CFs and insulin-to-carbohydrate ratios are only estimates and may result in either under- or overdelivery. Subcutaneous insulin delivery was based on interstitial glucose information; the controller was constrained as needed from excessive delivery of insulin, as demonstrated by the insulin delivery and dynamic IOB constraint results shown in Fig. 1A and B. Such a combination may be an effective trade-off in control design in that elevated glucose levels are treated aggressively while safety is maintained. Ideal glycemic control after unannounced, high carbohydrate meals is not feasible with the current delays associated with subcutaneously delivered insulin.

The model for the control algorithm was developed using ambulatory data only. The control law was evaluated off line for all possible scenarios, thus minimizing on-line computation. Tuning was based on “trust” in the model, and as a result, the closed-loop trials often were at the limit of the IOB safety constraint. The IOB safety constraint was “tuned” using the subject’s CF; hence, it is conceivable that future trials could tune the controller on the basis of the CF only. In the future, the AP controller will be updated as part of modifying insulin therapy during physician visits, using pump, sensor, and food diary data.

Closed-loop control transformed glucose variability to insulin variability as indicated in the lower panel of Fig. 1A, where the controller overcame the small unannounced meal without overdelivery of insulin as a result of the dynamic IOB constraint. The nature of intersubject variability in type 1 diabetes is demonstrated in Fig. 1B, where the closed loop started when the subject was in the hyperglycemia zone. The combination of mpMPC and IOB allowed the controller to facilitate recovery from hyperglycemia while restricting subsequent delivery of basal insulin without overdelivering. The AP managed to safely overcome this challenge as well as the unannounced meal with excellent glucose control. For this subject, 85.7% of the time was spent within 80–180 mg/dL (as measured by YSI).

As can be seen in Fig. 2A, the closed-loop cumulative glucose plot is narrow between 80 and 180 mg/dL where the outpatient CGM region spreads between 70 and 400 mg/dL. Although we acknowledge that the inpatient and outpatient conditions were not identical, the feasibility of the AP device to overcome the challenges set forth in the study was illustrated by the improvement of glucose control in inpatient versus outpatient settings. In addition, inpatient meals were largely of comparable size to outpatient meal records, and the sedentary nature of the inpatient setting presented more of a challenge in overcoming unannounced meals than in the ambulatory outpatient setting. In Fig. 2C, the average cumulative glucose tracing is almost identical, with a narrower spread in the YSI tracing than in the CGM tracing.

We have demonstrated a systematic design of the AP that meets the predefined requirements of full automation, safe regulation of glycemia without any human intervention, use of insulin only, and ability to be incorporated into a future portable device. The design of a future AP needs to follow a top-down approach that addresses control challenges as part of the system layout. Such a system needs to address issues with CGM accuracy and signal interferences to overcome sluggish insulin kinetics and control for physical activity. These challenges are currently being studied in clinical trials of longer duration that will transition from in-clinic to ambulatory clinical studies.

 Supplementary Material

   

Figure 1

Clinical results output from two closed-loop trials (study numbers 15 [A] and 10 [B]) demonstrating the ability of the design to effectively and safely overcome daily challenges of individuals with type 1 diabetes, such as hyperglycemia, unannounced meals, and avoiding postprandial hypoglycemia. For both cases, excellent automated glucose control was observed with 54.5 and 64.3% of the time in tight control (80–140 mg/dL). BG, blood glucose.

Figure 2

Percent time in different glycemic ranges for all subjects for outpatient collected data versus study day data as measured by CGM (A and B) and over the study day for all subjects as measured by CGM and YSI (C and D). No subjects experienced hypoglycemia, and they were in the safe range (80–180 mg/dL) for an average of 70% of the time, with a fraction of time in the mild hyperglycemia range and negligible time in the hyperglycemia range, as measured by YSI. *Statistically significant at P < 0.05.

Figure 3

CVGA before and after the study for CGM (A) and YSI (B).⬜, prestudy values; ●, study values. The prestudy values for the YSI CVGA were finger-stick values. The nine categories within the CVGA grid represent different levels of control as follows: accurate control (A-zone), benign deviation into hypoglycemia (lower B-zone), benign deviation into the hyperglycemia range (upper B-zone), benign control (B-zone), overcorrection of hyperglycemia (lower C-zone), overcorrection of hypoglycemia (upper C-zone), failure to manage hypoglycemia (lower D-zone), failure to manage hyperglycemia (upper D-zone), and erroneous control (E-zone).

