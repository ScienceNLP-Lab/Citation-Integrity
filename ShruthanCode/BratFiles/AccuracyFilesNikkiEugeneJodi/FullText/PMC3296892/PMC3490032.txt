Antiretroviral dynamics determines HIV evolution and predicts therapy outcome

Abstract

Despite the high inhibition of viral replication achieved by current anti-HIV drugs, many patients fail treatment, often with emergence of drug-resistant virus. Clinical observations show that the relationship between adherence and likelihood of resistance differs dramatically across drug class. We developed a mathematical model that explains these observations and makes novel predictions. Our model incorporates drug properties, fitness differences between susceptible and resistant strains, mutation, and adherence. We show that antiviral activity falls quickly for drugs with sharp dose-response curves and short half-lives, such as boosted protease inhibitors, limiting the time when resistance can be selected. We find that poor adherence to such drugs causes failure via growth of susceptible virus, explaining puzzling clinical observations. Furthermore, our model predicts that certain single-pill combination therapies can prevent resistance regardless of patient adherence. Our approach represents a first step for simulating clinical trials and may help select novel drug regimens for investigation.

Introduction

The prognosis of HIV infection has dramatically improved since the introduction of highly active antiretroviral therapy (HAART), which, when successful, can bring viral loads below the detection limit, improve immune function, and prevent progression to AIDS1. Although a complete understanding of how virologic, pharmacologic, and host factors interact to determine therapeutic outcome is still lacking, it is clear that a major obstacle to successful treatment is suboptimal drug adherence. Non-adherence can lead to virologic failure and the emergence of drug resistance2–5.

Because of their high antiviral activity, protease inhibitors (PIs) play a crucial role in HIV-1 treatment, and are used in three of the five recommended initial regimens and many salvage regimens6. Clinical trials have shown that for many drug combinations involving PIs, treatment failure occurs without resistance mutations in the protease gene7–10, though mutations conferring resistance to other drugs in the regimen are often found. It is generally believed that combination therapy works because it is unlikely that multiple mutations conferring resistance to all drugs in the combination will appear in the same viral genome. Thus, failure without PI resistance is puzzling because it appears to contradict this fundamental explanation for the success of HAART. It is commonly believed that PIs have a higher “barrier to resistance” than other drugs, meaning that clinically significant PI resistance requires the accumulation of multiple mutations in the protease gene11. PI resistance also typically occurs at a narrower range of adherence levels than resistance to other drug classes3;12. While these concepts are suggestive, no theory has been developed to explain why patients fail PI-based regimens without PI resistance.

A resistance mutation may exist prior to treatment in the latent or active viral populations, or may arise during treatment13. Drug resistance develops clinically if the mutant strain is selected over the wild-type strain. Selection depends on the fitness costs and benefits of the mutation, as well as on drug levels, which vary with the dosing interval, the drug half-life, and the patient’s adherence. Here we use a modeling approach to integrate these factors, enabling us to determine when a resistance mutation will be selected and to predict the outcome of therapy with different drugs. Our results explain the unique adherence-resistance relationship for PIs and show why patients fail PI-based therapy without PI resistance.

Results

Defining the mutant selection window

Antiretroviral drugs reduce viral fitness in a dose-dependent manner (Fig. 1a). Viral fitness can be summarized as a single parameter, the basic reproductive ratio R0, which encompasses all phases of the viral life-cycle14 (Supplementary Methods). The Hill dose-response curve describes the relationship between drug concentration and R0:   

Here D is drug concentration, IC50 is the concentration at which 50% inhibition occurs, and m is a parameter determining steepness of the curve15;16. The numerator R00 is baseline fitness in the absence of treatment.

A drug-resistant mutant is any viral variant that is less inhibited than the wild type for some drug concentration, described by the altered dose-response curve,

Mutations have a fitness cost, meaning that the drug-free fitness of the mutant virus is reduced by a fraction s (0 < s < 1). In the presence of the drug, the mutation confers a benefit, multiplying the IC50 by a factor ρ (the fold-change in IC50, ρ> 1). Many mutations also reduce the slope (m) of the dose-response curve by a fraction σ < 017.

Virologic failure (VF) occurs when treatment fails to prevent the growth of virus to high levels. A viral strain grows when R0> 1. The strain with highest R0 out-competes others14. The range of drug concentrations where a resistant mutant can cause VF is called the Mutant Selection Window (MSW)18;19. Above the MSW even replication of the mutant is suppressed (R′ (D) < 1), although toxicity may prevent these drug concentrations from being achieved clinically. We define the Wild-type Growth Window (WGW), where drug concentrations are so low that wild-type virus is not adequately suppressed and failure can occur even without resistance (R (D) > 1).

The MSW explains therapy outcome patterns

To predict a drug’s vulnerability to resistant and susceptible strains, we computed the time during a treatment interruption that a patient spends in the MSW and WGW. During treatment interruption, both R0 and R′0 increase. Up to four selection ranges can be identified (Fig. 1b). Using pharmacokinetic and pharmacodynamic data16;17, we determined the time spent in these ranges for 66 drug-mutation pairs (Fig. 2a) based on their specific dose-response curves (Figs. 2b–e). For each pair, we show how soon after the most recent dose the mutant or wild-type virus starts to grow. This quantity is shorter than the expected time until VF, which requires the plasma HIV RNA to reach detectable levels and may also depend on the time until mutant virus appears. Throughout the paper we examine only single-point mutations that are fully characterized by their effect on the dose-response curve ( ). In the Discussion, we address the extension to multiple mutations.

Successful treatment must both minimize the time spent in the MSW and delay entry into the WGW. These two goals are in tension, as shortening the time spent in the MSW (e.g., by decreasing drug half-life) can also hasten entry into the WGW (Fig. 1b). Results from our model (Fig. 2a) suggest that NNRTIs are protected against failure via wild-type virus due to their long half-lives, but are vulnerable to mutation due to the time spent in the MSW. PIs are at the opposite end of the spectrum, with little time spent in the MSW but rapid entry into the WGW. This behavior is caused by high slope parameters (extreme sensitivity to changes in concentration) and short half-lives. These results explain the unique bargain of PI therapy: greater protection against the evolution of resistance, but vulnerability to wild type-based VF after short treatment interruptions. This trade-off is depicted schematically by plotting the drugs along a single axis, which measures the relative risk of mutant growth versus wild-type growth, independent of the overall risk of VF (Fig. 2f, Supplementary Methods).

Simulation of clinical outcomes

While the MSW and WGW concepts describe instantaneous growth of mutant and wild-type virus for a given drug concentration, VF depends on sustained growth and, therefore, drug concentrations over time. To explain clinical observations across drug classes and adherence levels, we developed a stochastic model of viral evolution (Fig. 3 ). Our model builds on the large body of previous work modeling HIV therapy14;20–23 by integrating new data on class-specific drug properties16 and realistic costs and benefits of mutations17. We also modified past approaches by allowing drug concentrations, and hence R0, to fluctuate instead of taking time-averages.

We first simulated 48-week trials of single agents in a cohort of patients. The results are presented in two ways: as outcome versus patient adherence, at the trial endpoint (Fig. 4a), and as outcome versus time, for a distribution of patient adherence levels (Fig. 4b–c).

Consistent with previous meta-analysis of combination therapy clinical trials24, our model predicts that the level of adherence necessary for mutant VF differs by drug class (Fig. 5). Specifically, for the NNRTIs efavirenz (EFV) and etravirine (ETV), the risk of mutant VF is greatest at low adherence levels; for unboosted PIs, the risk peaks at a higher adherence level and remains substantial up to 100% adherence; and for boosted PIs, resistance occurs infrequently and at intermediate adherence levels. Researchers have previously argued that drug half-life and fitness costs of mutations are important factors explaining these general trends3;12. By incorporating these factors as parameters, our model formalizes this argument.

Examining simulations of each drug individually (Supplementary Figs. 3–9), we find four qualitative patterns of outcome, which correspond closely – but not exactly – to drug class (Fig. 4).

For most NRTIs, the IIs, the fusion inhibitor (FI), and the NNTRI NVP, even perfect adherence leads to mutant VF in all simulated patients. As adherence declines, some wild-type VF occurs. VF and resistance occur soon after the trials are started. These results are consistent with the notion that monotherapy often leads to rapid evolution of resistance.

For most PIs and the NNRTIs EFV and ETV, however, perfect adherence results in treatment success in simulations. Control of viral replication has been observed in a substantial fraction of patients in PI monotherapy trials25, but similar trials with EFV and ETV have not been carried out. In simulations, declining adherence affects performance of these two drug classes differently.

For the NNRTIs EFV and ETV, there is a large range of low-to-intermediate adherence for which mutant VF is likely. Below this range, wild-type VF becomes increasingly likely, while above this range patients succeed. The size of this range is explained by low fitness costs of drug-resistant mutations and long half-lives of NNRTIs, which allow the patient to remain within the MSW for a substantial duration (suggested in 26).

The PI nelfinavir (NFV) and the NRTI didanosine (ddI) show a large range of intermediate adherence leading to mutant VF. Near-perfect adherence is required for treatment success. Under most clinical settings (adherence < 95%), our model predicts that these drugs perform similarly to monotherapy with other NRTIs, typically leading to mutant VF.

For many PIs, a decline from perfect adherence leads abruptly from success to wild-type VF, with little or no intermediate range for mutant VF. This result explains the outcomes of clinical studies, which have shown that VF in many boosted PI-based regimens (including monotherapy) does not require the evolution of resistance7–9. Variations on this pattern exist for some PIs: lopinavir (LPV/r), saquinavir (SQV, SQV/r), and indinavir (IDV, IDV/r) do admit mutant VF at low and moderate adherence levels, mainly for suppression trials. Still, like all the PIs simulated except NFV, as adherence declines from the successful range, the first failing outcome observed is wild-type VF (Supplementary Figs. 3, 4).

We also examined the sensitivity of our results to changes in the baseline viral fitness, R00 (Supplementary Figs. 10, 11). Since intracellular half-lives of several NRTIs are not definitively established, we tested a range of half-lives for 3TC, AZT, d4T, ddI, and TDF (Supplementary Fig. 12).

Explaining outcomes of combination therapy

Equipped with a model of drug interaction, we can extend the simulations to combination therapy (Supplementary Methods, Supplementary Fig. 13). For proof-of-concept, we use a two-drug combination of the boosted PI darunavir (DRV/r) with the II raltegravir (RAL). The combined effect of these two drugs is given by a Bliss-independent27 interaction pattern28, which describes drugs acting on different targets, therefore reducing viral replication multiplicatively. In a recent DRV/r-RAL clinical trial8 patients experiencing VF had their plasma viral population genotyped. While 17% of patients tested positive for RAL-resistance mutations in the integrase gene, no patients tested positive for DRV resistance in protease8. Our simulation is consistent with this study: treatment failure occurs without DRV resistance (Fig. 6a).

RAL-resistant mutants are selected only when the concentration of DRV/r is low and the concentration of RAL is moderate-to-high. This particular state can occur if the drugs are administered as separate pills. If, however, dual therapy were administered as a combination pill, then the two concentrations would rise and fall roughly together, reducing the chance that they reach the discordant levels that select for resistance. Simulation of dual therapy as a single combination pill verifies this hypothesis. However, this protection from resistance comes at a cost: higher adherence is required to prevent wild-type VF. For example, to ensure a 95% chance of success in the simulation, a patient taking separate pills must be 25% adherent to each pill (Fig. 6b), but 35% adherent to a combination pill (Fig. 6c). We expect this trend to apply to other drug combinations.

Discussion

Recent efforts to quantify pharmacodynamics16;17;29, combined with insights into patients’ drug-taking behavior30, have enabled us to develop the first explanatory model of virologic failure in agreement with clinical trials. All parameters in our model have direct physical interpretations, and their values were taken directly, or derived from, previous literature. The model was not fit or trained to match clinical data. Despite our model’s simplicity, it can explain the clinically observed drug-class-specific relationship between adherence and outcome24 (Fig. 5). Even without full viral dynamic simulations, a straightforward analysis of the mutant selection window can explain why certain drugs are more likely to select for resistance (Figs. 2f, 5b).

In addition, we address a long-standing puzzle of antiretroviral therapy. Even when failure of PI-based regimens is documented, mutations that confer resistance to the PI appear infrequently7–10. While it is possible that mutations may occur outside the protease gene31–34 and escape routine detection, our model provides a more straightforward explanation: due to the sharp slope of PI dose-response curves16, even relatively strong PI resistance mutations are selected only in a narrow range of drug concentrations. Moreover, as PI concentrations decay rapidly compared to other drugs, they traverse this narrow range quickly, leaving little time for a resistant strain to grow before wild type-based VF. We predict that patients who fail PI therapy with wild-type virus should be able to re-suppress virus if the same drug is taken with improved adherence. Kempf et al.12 observed this outcome in patients who failed LPV/r without detectable resistance. Even with PIs that are more susceptible to resistance, only wild-type virus is detectable when adherence dips below the level guaranteeing success, providing an “anti-resistance buffer” that may warn clinicians of resistance risk. NFV is the sole exception to this pattern, owing to it having the lowest slope and second highest IC50 of the PIs, and consistent with its documented vulnerability to resistance12.

The tradeoff between protection from resistant and susceptible strains occurs not only between drug classes, but also between different formulations of the same drugs. We predict that a novel combination pill containing DRV/r and RAL would not lead to resistance, even though the current separate-pill formulation does. This result suggests that some combination pills may be “resistance-proof,” but their known benefit of increasing patient adherence must be weighed against the fact that they require higher adherence to prevent wild type-based VF. This tradeoff results from the possibility that a patient who is prescribed multiple pills may at times take only some of them35, providing partial protection from the virus but allowing entry into a “zone of monotherapy”26 that can select for resistance.

We can extend our model to a broader range of combination therapies once interactions between drugs28 are characterized; these interactions affect the evolution of resistance36. Our monotherapy results are a first step for examining how pharmacokinetics and pharmacodynamics determine treatment outcomes. These results can inform innovations in lower-cost maintenance therapy among highly adherent patients, for whom monotherapy shows promise, but also poses resistance risks25. Specifically, based on our simulations, we propose that EFV and ETV monotherapy may be promising avenues for further study, despite disheartening performance of monotherapy with the first approved NNRTI, NVP37, and ambiguous performance of ETV-based HAART for patients with resistance to the NRTI backbone38.

Maintenance and suppression therapy generally showed similar outcomes; however, for several drugs, failure with resistance was more likely during the suppression phase. Such differences are often attributed to the presence of pre-existing mutants when viral load is high39–42. However, in our model frequent reactivation from the latent reservoir provides a sufficient source of mutants during both phases (Supplementary Tables 5, 6), and ongoing replication is an additional common cause of resistance (Supplementary Figs. 8, 9). The key difference between the two phases is in how VF is defined. Since patients remained in suppression simulations until the predefined endpoint, wild-type growth sometimes preceded (and contributed to) growth of the mutant. More frequent measurement of viral load in maintenance simulations improved the chance that VF was diagnosed before resistance reached detectable levels, consistent with clinical meta-analysis43. Also consistent with clinical observations44, continuation of maintenance trials after rebound allowed the possibility of re-suppression, but sometimes led to emergence of resistance (Supplementary Fig. 7).

It is difficult to quantitatively compare our simulations to clinical trials, since adherence is rarely precisely known. We suspect that our results are biased towards success for several reasons. First, we considered only single-point mutations, but strains with multiple mutations may lead to failure at higher adherence levels. Second, we considered neither correlations between consecutive missed doses nor variations in the time of day when a dose is taken, both factors which lead to longer treatment interruptions and increase the chance of VF20;45–48. Third, as is common in models of viral dynamics, we assumed that the virus population is homogeneous and well-mixed. Actual infections may include subpopulations that grow faster (higher R0, e.g., due to cell-to-cell transmission49) or that reside in tissues that drugs do not fully penetrate50–52. For example, the concentration of EFV in the cerebrospinal fluid is only 0.5% of plasma concentrations53. Since our predictions rely on plasma drug concentrations, they may be optimistic in the case of EFV. In the absence of strong evidence for these effects, suboptimal adherence is the most likely cause of treatment failure.

Patients experiencing VF may not respond to a similar regimen in the future45;54;55, but the precise reasons for this are not clear. The simplest explanation is that growth of a resistant strain during prior treatment makes it more likely this strain will exist in the future56. This explanation assumes that, in the absence of prior growth, most resistant mutants are relatively rare. If the diversity (“effective population size”) of the latent reservoir is not severely depleted over time, then our calculations contradict this assumption for single mutations: even in the absence of prior treatment, a majority of mutations exit the reservoir every few weeks. Resistance is then available to be selected regardless of prior growth. The occurrence of multiple mutations within the same viral genome is unlikely, however, without prior growth. To explain generally how prior VF undermines future treatment, we need to model the long-term accumulation of multi-step mutations in the viral population57;58. To build such models, it will be important to understand interactions between mutations (including compensatory mutations) and account for recombination59.

Throughout this paper, we have emphasized the variable nature of anti-HIV drug resistance. Common practice classifies a genotype as “resistant” if it is associated with VF in a meta-analysis of clinical outcomes; otherwise it is “sensitive.” This categorization is misleading: a mutation’s ability to promote viral growth depends on all drugs in a regimen, adherence, and the other mutations present. As standards of care evolve and study populations change, a mutation may gain or lose “resistant” status due to shifts in these confounding variables. Our model provides a rigorous alternative for evaluating resistance, by using mechanistic parameters to predict clinical outcomes. Our framework can help researchers prioritize drugs for clinical trials and select regimens for personalized HIV treatment.

Methods

Pharmacokinetics, pharmacodynamics, and the mutant selection window

Viral fitness followed Equation ( ) with parameters R00, IC50, and m. Fitness of resistant mutants followed Equation ( ) with parameters s, ρ, and σ. (Supplementary Tables 1, 3–4). Relative wild-type and mutant viral fitness values R0(D)/R00 and R′0(D)/R00 were measured using in vitro assays and were fit to Hill curves to determine the parameters IC50, m, σ, ρ, and s; these values were reported previously16;17. We estimated absolute in vivo viral fitness in the absence of drugs (R00) using measurements from previous studies (Supplementary Methods). We modeled drug concentration as instantaneously increasing after a dose to the steady state peak concentration (Cmax), and then decaying exponentially (with half-life T1/2) to the trough concentration (Cmin) before the subsequent dose. When doses were missed (representing suboptimal adherence) the concentration continued to decay, and a subsequent dose increased the concentration by ΔC = Cmax − Cmin.

We determined the bounds of the Mutant Selection Window (MSW) by solving for D in R0(D) = R′0(D) and R′0(D) = 1. We determined the upper bound of the Wild-type Growth Window (WGW) by solving R0(D) = 1. We computed the time after a single dose when a particular concentration D was reached by solving for t in D = Cmax × 2t/T1/2.

The MSW concept as applied here to antiretroviral therapy was adapted from the extensive literature on antibiotic resistance. Both in vitro and in vivo, drug concentrations that fluctuate within the MSW lead to the development of resistance, but those outside it do not (reviewed in19). While some studies of antibiotic-resistant E. coli have found no upper limit to the MSW60, no such results are known for antiretroviral resistance. The definition of the MSW most commonly used in antibiotic work is slightly different from the one we use, with the lower limit defined as R0(D) = 1 due to experimental constraints18. We have chosen to modify this definition, since selection for the mutant can occur even at lower drug concentrations where R0(D)> 1 61. The MSW and WGW can be described for each drug during combination therapy (Supplementary Methods).

Simulation of the viral dynamics model

Our model for HIV dynamics during antiretroviral drug treatment uses equations common in the literature14. These equations track the number of uninfected CD4+ cells, amount of free virus, and number of infected CD4+ cells. A constant number of uninfected cells are produced each day, and they die at a constant rate. Cells are infected at a rate proportional to the number of uninfected cells, the amount of virus, and the viral fitness. Virion production from infected cells is described by the burst rate, and virions are cleared at a constant rate. Infected cells have a higher death rate than uninfected cells. Additionally, we include a population of long-lived infected cells in the latent reservoir, which activate at a constant daily rate regardless of viral fitness. Because we are only interested in viral dynamics during treatment and at the initial stages of failure, we have ignored effects of the immune response. Viral fitness, and hence the rate of infection of new CD4+ cells, is determined by the baseline R0 and the drug concentration. All equations and parameters are given in the Supplementary Methods and Supplementary Table 7. In the Supplementary Methods, we also derive a simplified form of HIV dynamics that requires fewer parameters and only one state variable per viral strain; we used this simplified model to design our simulations. More detailed models that explicitly track multiple stages of the viral lifecycle may more accurately reflect some short-term dynamics, such as lags in viral growth during acute infection or lags in viral decay during the early days of treatment62;63. Summarizing viral fitness by a single parameter (R0) smooths out these dynamics.

There may be multiple strains of virus (wild-type and mutants) and consequently multiple types of infected cells. Even in the absence of drug, mutations will arise due to random errors in replication, though they will be selected against due to their fitness cost (s). Each mutation appears at a rate u that depends on the particular nucleotide changes required to effect the desired amino acid substitution (Supplementary Tables 2–4). The balance between these two processes results in all mutations being present in the population at an expected low level u/s, called mutation-selection equilibrium64;65. We assume that the plasma virus population reaches this equilibrium in each patient before treatment (i.e., that sufficient time has passed between initial infection and treatment initiation, and that no prior treatment has selected for resistance to the particular drug being studied) and that the population in the latent reservoir is representative of the plasma population (Supplementary Tables 5, 6). De novo mutations occur with a probability u during replication.

We used stochastic simulations to study the dynamics of the system described. Many mutations have been characterized for each drug, and to model a realistic worst-case scenario, we considered a single “synthetic” mutant defined as having the highest benefits (ρ, negative σ), lowest cost (s), highest mutation rate, and highest equilibrium frequency (due to mutation-selection balance) of all the single-nucleotide mutants known for that drug. Each monotherapy simulation therefore tracked only two strains, wild-type and mutant. For dual therapy, we considered three strains: wild-type, resistant to Drug 1, and resistant to Drug 2. Simulations modeled 48-week trials, using discrete timesteps of Δt = 30 minutes. All simulations were done in Matlab R2010b. The full details of the algorithm for simulating a single patient are given in the Supplementary Methods.

In maintenance trials patients begin with full viral suppression (2 c ml−1) and undergo monotherapy for 48 weeks or until virologic failure (VF), whichever occurs first. VF is defined as “confirmed rebound”: two consecutive weekly measurements (starting at week 5) with viral load above 200 c ml−1. In suppression trials, patients begin with a realistic distribution of treatment-naive viral loads (between 3000 and 106 c ml−1) (Supplementary Fig. 2a) and undergo monotherapy for a full 48 weeks. We tracked measurements every 2 weeks. VF is defined as a viral load above 50 c ml−1 at week 48. In both types of trials, VF is classified as “with resistance” if at least 20% of the viral population at the time of detection is mutant.

We simulated imperfect adherence by allowing each dose to be missed with a constant probability given by the expected adherence level parameter. In reporting outcomes versus time, we simulated patients with a distribution of adherence levels taken from a study using unannounced pill counts30. For simulations with two drugs, the value of adherence may be different for each drug, allowing for “differential adherence” – which has been observed in many studies35. Even when adherence to the two drugs has the same average value, the drugs can be simulated as two separate pills (allowing each pill to be taken or forgotten independently) or as a single combination pill (causing the two drug concentrations to rise and fall in lockstep).

Supplementary Material

  

Figure 1

Drug concentrations determine the relative fitness of the wild-type virus and a resistant mutant. ( ) The fitness of the wild-type virus (R , blue line) decreases with increasing drug concentration, following Equation ( ). A drug-resistant strain (R′ , red line) is less fit than the wild type at low concentrations, but more fit at higher concentrations due to an increased IC50 or a reduced slope. The mutant selection window (MSW) is the range of concentrations where a resistant mutant, if present, will grow faster than the wild type and still has R′0> 1. The wild-type growth window (WGW) is the range of low concentrations where the wild type has R0> 1, leading to treatment failure without the need for resistance. For drug concentrations in the overlapping range of these windows, virologic failure (VF) can occur even without resistance, but will be hastened by the appearance of a faster-growing mutant. ( ) As drug concentrations decay after the last dose is taken, the viral fitness passes through the four different selection ranges. Depending on the drug, dose level, and mutation, not all of these ranges may exist. The time spent in each selection window is also determined by the drug half-life.

Figure 2

Selection windows can be calculated for particular drug-mutation pairs. ( ) The distance to the right along each horizontal bar is the time since the last dose, and the color corresponds to the selection window during that time interval (described in Fig. 1b) ( )–( ) Examples of dose-response curves for drug-mutation combinations indicated in (a). Shading indicates the MSW. If the cost of a mutation is too high or its benefit (ρ or σ) too low, it is possible that the MSW does not exist. ( ) Rank of each drug for relative risk of wild-type versus mutant virus growth, independent of the overall risk of therapy failure. For each drug, we show a “synthetic,” worst-case, single-nucleotide mutation (Supplementary Methods, Supplementary Fig. 1). NRTI & NNRTI, (non)-nucleoside/nucleotide reverse transcriptase inhibitors; PI, protease inhibitors; FI, fusion inhibitors; II, integrase inhibitors; 3TC, lamivudine; ABC, abacavir; AZT, zidovudine; d4T, stavudine; ddI, didanosine, FTC, emtricitabine; TDF, tenofovir disoproxil fu-marate; EFV, efavirenz; ETV, etravirine; NVP, nevirapine; ATV, atazanavir; DRV, darunavir; IDV, indinavir; LPV, lopinavir; NFV, nelfinavir; SQV, saquinavir; TPV, tipranavir; EVG, elvitegravir; RAL, raltegravir; ENF, enfuvirtide. PIs are often “boosted” (co-formulated) with ritonovir (/r), which interferes with break-down in the liver and increases half-life.

Figure 3

Schematic of algorithm for simulating viral dynamics in a patient undergoing treatment. ( ) A single simulated patient takes a particular drug (or drug combination) with a designated adherence level, starting with a chosen initial viral load. Over a 48-week clinical trial, drug levels fluctuate and viral load levels are simulated according to a viral dynamics model. ( ) Drug levels fluctuate according to patient’s dosing pattern and pharmacokinetics (dose size, half-life, bioavailability); gaps show missed doses (figure shows single drug). ( ) Wild-type viral fitness (R0) fluctuates in response to drug concentration depending on the dose-response curve. ( ) Fitness of drug-resistant strain (R′0) depends on an altered dose-response curve; at high drug concentrations, mutant fitness exceeds that of the wild type. ( ) Wild-type viral load depends on viral dynamics equations, which account for active replication, exit from the latent reservoir, and competition between strains. ( ) A mutant virus may appear (red star) but be below the threshold for detection (dotted red line) before eventually leading to virologic failure.

Figure 4

Outcomes for simulated patients in a clinical trial. The height of the area shaded indicates probability of the corresponding outcome at a given adherence level (a) or time-point (b and c). ( ) Adherence (x-axis) is defined as the fraction of scheduled doses taken. These are maintenance trials (see Methods). (b–c) Time is on the x-axis; measurements are taken every 2 weeks for simulated patients with a distribution of adherence levels (Supplementary Methods, Supplementary Fig. 2b). ( ) Suppression trials (see Methods). ( ) Maintenance trials. (I) 3TC therapy (pattern includes AZT, ABC, d4T, ENF, EVG, FTC, NVP, RAL, TDF). (II) EFV and ETV therapy. (III) NFV therapy (pattern includes ddI). (IV) DRV/r and ATV/r therapy (pattern includes ATV, TPV/r; variation on this pattern described in text includes LPV/r, SQV, SQV/r IDV, IDV/r).

Figure 5

Our calculated adherence-resistance relations are in agreement with those observed in clinical trials. ( ) Adherence versus simulated probability of resistance in a 48-week suppression trial for a PI, a boosted PI and an NNRTI. The inset shows a qualitative summary of results from a meta-analysis of clinical trials24, which agrees with our simulations. ( ) Adherence versus fraction of time spent in the MSW for the same drugs. Adherence-resistance trends demonstrate that “time in MSW” is a good proxy for the risk of mutant-based virologic failure (VF). For both plots, curves were generated by averaging over all boosted PIs, all unboosted PIs, and the NNRTIs EFV and ETV. PI curves in (a) were fitted to skewed-T distributions to smooth step-like behavior. NVP, which was excluded from this figure, displays a different pattern from the other two NNRTIs; specifically, mutant VF can occur even for perfect adherence (Supplementary Figs. 3, 4).

Figure 6

Outcomes of DRV/r + RAL dual suppression therapy simulations, considering resistant mutants for both drugs. ( ) Each drug is taken independently and adherence may differ between them. The brightness of each color at a particular point indicates the probability of the corresponding outcome, with the black contours showing where each outcome occurs 95% of the time. Success depends largely on adherence to DRV/r (almost certain if > 50%), while the type of failure is determined by adherence to RAL (resistance almost certain if > 30%). All failure via resistance is due to RAL mutant-based VF. DRV mutant-based virologic failure (VF) never occurs in the simulations. (b)–(c) Drugs are taken with equal average adherence. The height of the area shaded indicates probability of the corresponding outcome at that adherence level. ( ) Drugs are taken as separate pills. Average adherence is the same but pills are taken independently. ( ) Drugs are packaged as a combination pill and are always taken together. Mutant VF occurs only when the two drugs are given in separate pills; combination pills eliminate mutant VF but increase the adherence required for near-certain success.

